<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>BOIN-COMB - Treatment Combination Designs • escalation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="BOIN-COMB - Treatment Combination Designs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">escalation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A100-DoseSelectors.html">Using escalation</a></li>
    <li><a class="dropdown-item" href="../articles/A205-CRM.html">CRM - Continual Reassessment Method</a></li>
    <li><a class="dropdown-item" href="../articles/A207-NBG.html">NBG - Neuenschwander, Branson &amp; Gsponer</a></li>
    <li><a class="dropdown-item" href="../articles/A210-TPI.html">TPI - Toxicity Probability Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A220-mTPI.html">mTPI - Modified Toxicity Probability Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A230-BOIN.html">BOIN - Bayesian Optimal Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A280-TITE.html">TITE-CRM and TITE-NBG - Time-to-Event Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A310-EfficacyToxicity.html">EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A360-Combinations.html">BOIN-COMB - Treatment Combination Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A600-DosePaths.html">Working with dose-paths</a></li>
    <li><a class="dropdown-item" href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a></li>
    <li><a class="dropdown-item" href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/brockk/escalation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>BOIN-COMB - Treatment Combination Designs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/master/vignettes/A360-Combinations.Rmd" class="external-link"><code>vignettes/A360-Combinations.Rmd</code></a></small>
      <div class="d-none name"><code>A360-Combinations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The great majority of dose-finding designs are intended for use on a
single treatment whose dose is being varied. There are a small number of
designs that are intended for dose-finding in multiple therapies
combined, where the dose of more than one treatment can be varied. A
notable feature of this challenge is that the resulting dose space is
multi-dimensional. There is no longer a single optimal dose or maximum
tolerable dose to identify but a contour of treatment combinations that
have similar event probabilities.</p>
</div>
<div class="section level2">
<h2 id="outcome-nomenclature">Outcome nomenclature<a class="anchor" aria-label="anchor" href="#outcome-nomenclature"></a>
</h2>
<p>The outcome syntax used elsewhere in <code>escalation</code> to
represent the patient-level doses administered and outcomes experienced
has been extended to handle treatment combinations. The only material
change is in how the dose is written. In a monotherapy setting, we would
write <code>1</code> for dose-level 1 and <code>2</code> for dose-level
2, etc. In the treatment combination setting, we use a dotted decimal
notation (like that used in IP-addresses), so that, for example, the
third dose-level of the first treatment paired with the fourth
dose-level of the second treatment is written as <code>3.4</code>. The
same outcome designators <code>E</code>, <code>T</code>, <code>B</code>
and <code>N</code> (representing efficacy only, toxicity only, both
effiecacy and toxicity, and neither efficacy nor toxicity) are strung
after the dose to represent the outcomes of patients in cohorts. There
currently are no designs implemented in <code>escalation</code> that
investigate efficacy and toxicity in treatment combincations but the
syntax can theoretically accomodate them.</p>
<p>For illustration, let us imagine a dose-finding trial of three
treatments in a trial where each patient can either experience toxicity
<code>T</code>, or no toxicity <code>N</code>. Suppose further the first
cohort of three patients is treated at the first dose-level of each of
the three therapies and none of the patients experiences toxicity. The
outcome string to reflect this is:</p>
<p><code>1.1.1NNN</code></p>
<p>Now suppose, by way of some experimental design, we decide that the
dose-level of the first treatment should be escalated to the second
level whilst the dose-level of the second and third treatments is kept
at level 1. The dose string will become <code>2.1.1</code>. Suppose we
give this dose to a cohort of three new patients, and that two of the
patients tolerate without toxicity but the third patient experiences
tox. The outcome string for the whole trial so far is:</p>
<p><code>1.1.1NNN 2.1.1NNT</code></p>
<p>This syntax can be used to describe the doses and outcomes for any
arrangement of discrete dose-levels in any number of treatments.</p>
</div>
<div class="section level2">
<h2 id="boin-comb">BOIN-COMB<a class="anchor" aria-label="anchor" href="#boin-comb"></a>
</h2>
<p>The BOIN method was originally presented by <span class="citation">Liu and Yuan (2015)</span> for dose-finding in a single
treatment. BOIN-COMB <span class="citation">(Lin and Yin 2017)</span>
generalises BOIN to investigate doses in exactly two treatments (not
more) in search of dose pairs with toxicity probability close to a
pre-specified target rate. Currently, BOIN-COMB is the only design for
treatment combinations implemented in <code>escalation</code> We
demonstrate some examples below.</p>
</div>
<div class="section level2">
<h2 id="implementation-in-escalation">Implementation in <code>escalation</code><a class="anchor" aria-label="anchor" href="#implementation-in-escalation"></a>
</h2>
<div class="section level3">
<h3 id="boin-comb-1">BOIN-COMB<a class="anchor" aria-label="anchor" href="#boin-comb-1"></a>
</h3>
<p>We now demonstrate BOIN-COMB, focusing on how the shape of returned
objects is different to monotherapy dose-finding.</p>
<p>In their treatment combination examples, the <code>BOIN</code>
package authors investigate a situation where there are three doses of
the first treatment being paired with five doses of the second
treatment, targeting a 30% toxicity rate. The first big difference
compared to monotherapy dose-finding is that <code>num_doses</code> now
must be a vector rather than a scalar integer:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://brockk.github.io/escalation/" class="external-link">escalation</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">num_doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span></code></pre></div>
<p>We create a dose selector:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boin_fitter</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>By default, the lower and upper toxicity rate thresholds in BOIN-COMB
are set to <code>p.saf = 0.6 * target = 0.18</code> and
<code>p.tox = 1.4 * target = 0.42</code>, so the above call is
equivalent to:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span>, </span>
<span>  p.saf <span class="op">=</span> <span class="fl">0.18</span>, p.tox <span class="op">=</span> <span class="fl">0.42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Naturally we can override those with our own values to make
escalation harder or easier.</p>
<p>We now fit the model to outcomes. The authors investigate
outcomes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">"1.1NNN 2.1NNNNNNT 2.2NNNNNT"</span></span></code></pre></div>
<p>I.e. the first cohort of three is treated at the lowest dose
combination with no tox experienced; the second cohort, comprising seven
patients, is dosed at the second dose-level of the first treatment
paired with the first dose-level of the second treatment, with one
patient experiencing tox; and the third cohort, comprising six patients,
is dosed at the second dose-level of the first treatment paired with the
second dose-level of the second treatment, again with one patient
experiencing tox. As you can see, a lot of information is conveyed in 27
characters.</p>
<p>Let’s fit the model:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<p>leading to advice to continue:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>at dose <code>2.3</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span></code></pre></div>
<div class="section level4">
<h4 id="final-dose-selection">Final dose selection<a class="anchor" aria-label="anchor" href="#final-dose-selection"></a>
</h4>
<p>BOIN-COMB, like some other designs, selects the final dose
differently to how it selects doses mid-trial. To achieve this in
<code>escalation</code>, we need an extra selector that will kick-in
when the parent selector(s) have selected a non-NA dose but expressed
<code>continue == FALSE</code>, i.e. signaled <em>the trial ends now but
we are interested in a dose</em>. If used, it will almost surely come
last in the selector chain:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/select_boin_comb_mtd.html">select_boin_comb_mtd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1.1NNN 1.2NTN 1.2NNN 2.1TNT'</span></span>
<span><span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p>In the above example, <code>stop_at_n</code> stopped the trial
because the threshold sample size was met, and the underlying algorithm
identified that at least one dose was worthy of selection. At this
juncture, <code>select_boin_comb_mtd</code> took over and applied the
method described by the authors. Whilst the underlying selector(s) were
busy conducting the trial (<code>continue == TRUE</code>),
<code>select_boin_comb_mtd</code> kept silent.</p>
</div>
</div>
<div class="section level3">
<h3 id="combination-with-other-dose-selectors">Combination with other dose selectors<a class="anchor" aria-label="anchor" href="#combination-with-other-dose-selectors"></a>
</h3>
<p>We demonstrated above how <code>get_boin_comb</code> works with the
auxiliary dose-selector <code>stop_at_n</code>. In a similar way,
<code>get_boin_comb</code> will work with many other dose-selectors in
<code>escalation</code>.</p>
<p>For instance, we might wish to stop the trial once we have reached a
target sample size at recommended dose. For instance, the following
model wants to recommended dose <code>2.1</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/stop_when_n_at_dose.html">stop_when_n_at_dose</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, dose <span class="op">=</span> <span class="st">"recommended"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1.1NNN 2.1NTN'</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 1</span></span></code></pre></div>
<p>But it has reached the target sample size at that dose so it
advocates stopping:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Likewise, we could have specified a dose explicitly by the
dose-indices:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/stop_when_n_at_dose.html">stop_when_n_at_dose</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1.1NNN 2.1NTN'</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 1</span></span>
<span><span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>There are many other dose-selectors in escalation. PLease get in
contact if you discover a combination that does not work and you are
pretty sure that it should!</p>
</div>
<div class="section level3">
<h3 id="dose-paths">Dose paths<a class="anchor" aria-label="anchor" href="#dose-paths"></a>
</h3>
<p>Dose-paths for combinations are theoretically possible. However, at
present they are not implemented yet:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span></span>
<span>    cohort_sizes <span class="op">=</span> <span class="va">cohort_sizes</span>, </span>
<span>    previous_outcomes <span class="op">=</span> <span class="st">'1NNN'</span>, next_dose <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error in dose_paths_function.combo_selector_factory(selector_factory$parent): Dose-paths for combination studies not yet implemented.</span></span></code></pre></div>
<p>For more information on working with dose-paths, refer to the
dose-paths vignette.</p>
</div>
<div class="section level3">
<h3 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h3>
<p>Simulations are implemented for combination designs but there are
some necessary differences compared to monotherapy situations. To
illustrate, we will continue with the BOIN-COMB design already
introduced, that will use a modest sample size:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/select_boin_comb_mtd.html">select_boin_comb_mtd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Let us specify a plausible true dose-toxicity scenario:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_prob_tox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>,</span>
<span>                          <span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.45</span>, <span class="fl">0.55</span>, <span class="fl">0.65</span>,</span>
<span>                          <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>                        nrow <span class="op">=</span> <span class="va">num_doses</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                        ncol <span class="op">=</span> <span class="va">num_doses</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                        byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">true_prob_tox</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.10 0.20 0.30 0.40 0.50</span></span>
<span><span class="co">#&gt; [2,] 0.25 0.35 0.45 0.55 0.65</span></span>
<span><span class="co">#&gt; [3,] 0.30 0.40 0.50 0.60 0.70</span></span></code></pre></div>
<p>As with all designs in <code>escalation</code>, we perform
simulations like this:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span>num_sims <span class="op">=</span> <span class="fl">10</span>, true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span><span class="op">)</span></span></code></pre></div>
<p>By default, we get some useful output:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span></span>
<span><span class="co">#&gt; Number of iterations: 10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 3 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.10 0.20 0.30 0.40 0.50</span></span>
<span><span class="co">#&gt; [2,] 0.25 0.35 0.45 0.55 0.65</span></span>
<span><span class="co">#&gt; [3,] 0.30 0.40 0.50 0.60 0.70</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 3</span></span></span>
<span><span class="co">#&gt;    dose      dose_string prob_recommend</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> NoDose                 0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.1                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.2                    0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.5                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.1                    0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.2                    0.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.5                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.1                    0.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.2                    0.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.5                    0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.275 0.225 0.025    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.225 0.175 0.000    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.025 0.050 0.000    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;      12      12      12      12      12      12 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total toxicities:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     0.0     2.0     2.0     2.5     3.0     5.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Trial duration:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   6.915   9.249  10.877  11.298  13.933  15.887</span></span></code></pre></div>
<p>However, we can dive deeper. The same generics that can be invoked on
the sims object in monotherapy scenarios can also be used in
combinations studies. However, some of the formats of the returned
objects are different to reflect that dose is multi-dimensional. We
consider those generics each briefly now.</p>
<p>The number of patients in each simulated trial behaves as before:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_patients.html">num_patients</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 12 12 12 12 12 12 12 12 12 12</span></span></code></pre></div>
<p>The number of doses is now a vector:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_doses.html">num_doses</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 5</span></span></code></pre></div>
<p>The set of possible dose-indices is a list, with each element being a
vector on integers:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dose_indices.html">dose_indices</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 1 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 1 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 2 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 2 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] 2 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] 2 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; [1] 3 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[12]]</span></span>
<span><span class="co">#&gt; [1] 3 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[13]]</span></span>
<span><span class="co">#&gt; [1] 3 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[14]]</span></span>
<span><span class="co">#&gt; [1] 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[15]]</span></span>
<span><span class="co">#&gt; [1] 3 5</span></span></code></pre></div>
<p>That some information is more succinctly represented in
dotted-decimal string notation:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dose_strings.html">dose_strings</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "1.1" "1.2" "1.3" "1.4" "1.5" "2.1" "2.2" "2.3" "2.4" "2.5" "3.1" "3.2"</span></span>
<span><span class="co">#&gt; [13] "3.3" "3.4" "3.5"</span></span></code></pre></div>
<p>The recommended final dose in each iterate is available in string
form:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">sims</span>, dose_string <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "2.1" "2.2" "3.1" "2.1" "2.2" "1.2" "2.1" "1.2" "3.2" "1.2"</span></span></code></pre></div>
<p>or in matrix form, with simulated iterates in rows, treatment in
columns, and matrix cells represending the dose-index of the relevant
treatment:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">sims</span>, dose_string <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,]    2    1</span></span>
<span><span class="co">#&gt;  [2,]    2    2</span></span>
<span><span class="co">#&gt;  [3,]    3    1</span></span>
<span><span class="co">#&gt;  [4,]    2    1</span></span>
<span><span class="co">#&gt;  [5,]    2    2</span></span>
<span><span class="co">#&gt;  [6,]    1    2</span></span>
<span><span class="co">#&gt;  [7,]    2    1</span></span>
<span><span class="co">#&gt;  [8,]    1    2</span></span>
<span><span class="co">#&gt;  [9,]    3    2</span></span>
<span><span class="co">#&gt; [10,]    1    2</span></span></code></pre></div>
<p>The number of patients at each dose for a given trial is now a
multi-dimensional array, and a 2*2 matrix in BOIN-COMB. The same info
for many trials for convenience is represented as a list, with one item
for each simulated iterate:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/n_at_dose.html">n_at_dose</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    6    3    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    3    6    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    6    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    6    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    3    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    6    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    9    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    6    3    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    3    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    3    6    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span></code></pre></div>
<p>When focusing just on the sample size at the recommended dose, the
data is represented as a vector of integers:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/n_at_dose.html">n_at_dose</a></span><span class="op">(</span><span class="va">sims</span>, dose <span class="op">=</span> <span class="st">"recommended"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 3 6 3 6 3 6 9 6 3 6</span></span></code></pre></div>
<p>That same information is returned by:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/n_at_recommended_dose.html">n_at_recommended_dose</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 3 6 3 6 3 6 9 6 3 6</span></span></code></pre></div>
<p>Likewise, the number of toxicity events seen at each dose combination
in each ieterate is returned in a congruent form:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tox_at_dose.html">tox_at_dose</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    1    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    1    3    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    3    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    2    3    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    2    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0</span></span></code></pre></div>
<p>The total number of toxicities seen over all doses in each iterate is
simple to understand:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_tox.html">num_tox</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 2 3 2 4 2 2 3 5 0 2</span></span></code></pre></div>
<p>BOIN-COMB does not assess efficacy, but if it did, equivalent
functions would return the counts (but merely return NA here:)</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eff_at_dose.html">eff_at_dose</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]   NA   NA   NA   NA   NA</span></span>
<span><span class="co">#&gt; [2,]   NA   NA   NA   NA   NA</span></span>
<span><span class="co">#&gt; [3,]   NA   NA   NA   NA   NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]   NA   NA   NA   NA   NA</span></span>
<span><span class="co">#&gt; [2,]   NA   NA   NA   NA   NA</span></span>
<span><span class="co">#&gt; [3,]   NA   NA   NA   NA   NA</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_eff.html">num_eff</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] NA NA NA NA NA NA NA NA NA NA</span></span></code></pre></div>
<p>The probability of each dose being recommended is presented in a
data-frame, with column <code>dose</code> containing a vector of dose
indices for each dose (e.g. <code>c(1, 1)</code> for the pair of first
dose), and <code>dose_string</code> comprising the same in
dotted-decimal string format:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_recommend.html">prob_recommend</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 3</span></span></span>
<span><span class="co">#&gt;    dose      dose_string prob_recommend</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;chr [1]&gt;</span> NoDose                 0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.1                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.2                    0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 1.5                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.1                    0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.2                    0.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 2.5                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.1                    0.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.2                    0.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.3                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.4                    0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> <span style="color: #949494;">&lt;int [2]&gt;</span> 3.5                    0</span></span></code></pre></div>
<p>The probability of each dose being administered to a patient is
available average over all simulated iterates:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_administer.html">prob_administer</a></span><span class="op">(</span><span class="va">sims</span>, method <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.275 0.225 0.025    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.225 0.175 0.000    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.025 0.050 0.000    0    0</span></span></code></pre></div>
<p>or within in each iterate:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_administer.html">prob_administer</a></span><span class="op">(</span><span class="va">sims</span>, method <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.50 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.25 0.00    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25  0.0    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.25  0.5    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00  0.0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.50    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.25    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25 0.00    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.50 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25 0.50    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.75    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00    0    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25  0.5 0.25    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.00  0.0 0.00    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00  0.0 0.00    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.25 0.50    0    0    0</span></span>
<span><span class="co">#&gt; [2,] 0.00 0.25    0    0    0</span></span>
<span><span class="co">#&gt; [3,] 0.00 0.00    0    0    0</span></span></code></pre></div>
<p>The trial duration is simple to understand:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trial_duration.html">trial_duration</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 14.275537 10.076049  6.915256 12.905144  9.157043 14.414556 15.886741</span></span>
<span><span class="co">#&gt;  [8]  8.150282 11.678720  9.523587</span></span></code></pre></div>
<p><code>summary</code> gives a data-frame summary with doses (and
stopping without selecting a dose) as rows and much of the above
information in columns:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 6</span></span></span>
<span><span class="co">#&gt;    dose     tox     n true_prob_tox prob_recommend prob_administer</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> NoDose   0     0            0               0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1.1      0     3.3          0.1             0             0.275</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1.2      0.4   2.7          0.2             0.3           0.225</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1.3      0.3   0.3          0.3             0             0.025</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.4      0     0            0.4             0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1.5      0     0            0.5             0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2.1      0.5   2.7          0.25            0.3           0.225</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2.2      1     2.1          0.35            0.2           0.175</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2.3      0     0            0.45            0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2.4      0     0            0.55            0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2.5      0     0            0.65            0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 3.1      0.1   0.3          0.3             0.1           0.025</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 3.2      0.2   0.6          0.4             0.1           0.05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 3.3      0     0            0.5             0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 3.4      0     0            0.6             0             0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 3.5      0     0            0.7             0             0</span></span></code></pre></div>
<p><code>as_tibble</code> returns one row for each dose in each
simulated iterate, offering a deep-dive into the simulated trials:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 160 × 12</span></span></span>
<span><span class="co">#&gt;    .iteration .depth  time dose     tox     n empiric_tox_rate mean_prob_tox</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          1      5  14.3 NoDose     0     0            0           0      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          1      5  14.3 1.1        0     6            0           0.008<span style="text-decoration: underline;">20</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          1      5  14.3 1.2        2     3            0.667       0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          1      5  14.3 1.3        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          1      5  14.3 1.4        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          1      5  14.3 1.5        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          1      5  14.3 2.1        0     3            0           0.016<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          1      5  14.3 2.2        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          1      5  14.3 2.3        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          1      5  14.3 2.4        0     0          <span style="color: #BB0000;">NaN</span>           0.619  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 150 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: median_prob_tox &lt;dbl&gt;, admissible &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   recommended &lt;lgl&gt;, true_prob_tox &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Furthermore, the simulation comparison method of <span class="citation">Sweeting et al. (2024)</span> is implemented, allowing
us to efficiently investigate small differences in competing designs
with code like:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span>, </span>
<span>  p.saf <span class="op">=</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">target</span>, p.tox <span class="op">=</span> <span class="fl">1.4</span> <span class="op">*</span> <span class="va">target</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/select_boin_comb_mtd.html">select_boin_comb_mtd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin_comb.html">get_boin_comb</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="va">num_doses</span>, target <span class="op">=</span> <span class="va">target</span>, </span>
<span>  p.saf <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">target</span>, p.tox <span class="op">=</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">target</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/select_boin_comb_mtd.html">select_boin_comb_mtd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  model1 <span class="op">=</span> <span class="va">model1</span>,</span>
<span>  model2 <span class="op">=</span> <span class="va">model2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_compare.html">simulate_compare</a></span><span class="op">(</span></span>
<span>  designs <span class="op">=</span> <span class="va">designs</span>,</span>
<span>  num_sims <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Running model1 </span></span>
<span><span class="co">#&gt; Running model2</span></span>
<span><span class="fu"><a href="../reference/convergence_plot.html">convergence_plot</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code></pre></div>
<p><img src="A360-Combinations_files/figure-html/unnamed-chunk-37-1.png" width="672"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 150 × 22</span></span></span>
<span><span class="co">#&gt;    dose      n design.x hit.x design.y hit.y     X    X2     Y    Y2    XY  psi1</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1.1       1 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1.1       2 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1.1       3 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1.1       4 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1.1       5 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1.1       6 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1.1       7 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1.1       8 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1.1       9 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1.1      10 model2   FALSE model1   FALSE     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 140 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: psi2 &lt;dbl&gt;, v_psi1 &lt;dbl&gt;, v_psi2 &lt;dbl&gt;, cov_psi12 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   delta &lt;dbl&gt;, v_delta &lt;dbl&gt;, se_delta &lt;dbl&gt;, delta_l &lt;dbl&gt;, delta_u &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   comparison &lt;chr&gt;</span></span></span></code></pre></div>
<p>For more information on running dose-finding simulations, refer to
the simulation vignette.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lin2017bayesian" class="csl-entry">
Lin, Ruitao, and Guosheng Yin. 2017. <span>“Bayesian Optimal Interval
Design for Dose Finding in Drug-Combination Trials.”</span>
<em>Statistical Methods in Medical Research</em> 26 (5): 2155–67.
</div>
<div id="ref-liu_bayesian_2015" class="csl-entry">
Liu, Suyu, and Ying Yuan. 2015. <span>“Bayesian Optimal Interval Designs
for Phase <span>I</span> Clinical Trials.”</span> <em>Journal of the
Royal Statistical Society: Series C (Applied Statistics)</em> 64 (3):
507–23. <a href="https://doi.org/10.1111/rssc.12089" class="external-link">https://doi.org/10.1111/rssc.12089</a>.
</div>
<div id="ref-sweeting2023" class="csl-entry">
Sweeting, Michael, Daniel Slade, Daniel Jackson, and Kristian Brock.
2024. <span>“Potential Outcome Simulation for Efficient Head-to-Head
Comparison of Adaptive Dose-Finding Designs.”</span> <em>arXiv Preprint
arXiv:2402.15460</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
