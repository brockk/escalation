<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stop when uncertainty interval of prob tox is covered. — stop_when_tox_ci_covered • escalation</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stop when uncertainty interval of prob tox is covered. — stop_when_tox_ci_covered"><meta name="description" content="This method stops a dose-finding trial when the symmetric uncertainty
interval for the probability of toxicity falls within a range. This allows
trials to be stopped when sufficient precision on the pobability of toxicity
has been achieved. See Details."><meta property="og:description" content="This method stops a dose-finding trial when the symmetric uncertainty
interval for the probability of toxicity falls within a range. This allows
trials to be stopped when sufficient precision on the pobability of toxicity
has been achieved. See Details."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">escalation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A100-DoseSelectors.html">Using escalation</a></li>
    <li><a class="dropdown-item" href="../articles/A205-CRM.html">CRM - Continual Reassessment Method</a></li>
    <li><a class="dropdown-item" href="../articles/A207-NBG.html">NBG - Neuenschwander, Branson &amp; Gsponer</a></li>
    <li><a class="dropdown-item" href="../articles/A210-TPI.html">TPI - Toxicity Probability Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A220-mTPI.html">mTPI - Modified Toxicity Probability Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A230-BOIN.html">BOIN - Bayesian Optimal Interval Design</a></li>
    <li><a class="dropdown-item" href="../articles/A280-TITE.html">TITE-CRM and TITE-NBG - Time-to-Event Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A310-EfficacyToxicity.html">EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A360-Combinations.html">BOIN-COMB - Treatment Combination Designs</a></li>
    <li><a class="dropdown-item" href="../articles/A600-DosePaths.html">Working with dose-paths</a></li>
    <li><a class="dropdown-item" href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a></li>
    <li><a class="dropdown-item" href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/brockk/escalation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Stop when uncertainty interval of prob tox is covered.</h1>
      <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/master/R/stop_when_tox_ci_covered.R" class="external-link"><code>R/stop_when_tox_ci_covered.R</code></a></small>
      <div class="d-none name"><code>stop_when_tox_ci_covered.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method stops a dose-finding trial when the symmetric uncertainty
interval for the probability of toxicity falls within a range. This allows
trials to be stopped when sufficient precision on the pobability of toxicity
has been achieved. See Details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stop_when_tox_ci_covered</span><span class="op">(</span></span>
<span>  <span class="va">parent_selector_factory</span>,</span>
<span>  <span class="va">dose</span>,</span>
<span>  <span class="va">lower</span>,</span>
<span>  <span class="va">upper</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-parent-selector-factory">parent_selector_factory<a class="anchor" aria-label="anchor" href="#arg-parent-selector-factory"></a></dt>
<dd><p>Object of type <code><a href="selector_factory.html">selector_factory</a></code>.</p></dd>


<dt id="arg-dose">dose<a class="anchor" aria-label="anchor" href="#arg-dose"></a></dt>
<dd><p><code>'any'</code> to stop when the interval for any dose is covered;
<code>'recommended'</code> to stop when the interval for the recommended dose is
covered ; or an integer to stop when the interval for a particular dose-level
is covered.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Stop when lower interval bound exceeds this value</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Stop when upper interval bound is less than this value</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>Width of the uncertainty interval. Default is 0.9, i.e. a range
from the 5th to the 95th percentiles.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of type <code><a href="selector_factory.html">selector_factory</a></code> that can fit a
dose-finding model to outcomes.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The method for calculating probability mass for toxicity rates will
ultimately be determined by the dose-finding model used and the attendant
inferential mechanism. For instance, the <code><a href="https://rdrr.io/pkg/dfcrm/man/crm.html" class="external-link">crm</a></code> function in
the dfcrm package calculates the posterior expected mean and variance of the
slope parameter in a CRM model. It does not use MCMC to draw samples from the
posterior distribution. Thus, to perform inference on the posterior
probability of toxicity, this package assumes the dfcrm slope parameter
follows a normal distribution with the mean and variance calculated by dfcrm.
In contrast, the <code>stan_crm</code> function in the <code>trialr</code>
package needs no such assumption because it samples from the posterior
parameter distribution and uses those samples to infer on the posterior
probability of toxicity at each dose, dependent on the chosen model for the
dose-toxicity curve.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">skeleton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We compare a CRM model without this stopping rule:</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># To two with it, the first demanding a relatively tight CI:</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">stop_when_tox_ci_covered</span><span class="op">(</span>dose <span class="op">=</span> <span class="st">'recommended'</span>, lower <span class="op">=</span> <span class="fl">0.15</span>, upper <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># and the second demanding a relatively loose CI:</span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">stop_when_tox_ci_covered</span><span class="op">(</span>dose <span class="op">=</span> <span class="st">'recommended'</span>, lower <span class="op">=</span> <span class="fl">0.05</span>, upper <span class="op">=</span> <span class="fl">0.45</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1NNN 2NNN 3NNT 3NNN 3TNT 2NNN'</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="va">model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va">model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="va">model3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Naturally the first does not advocate stopping:</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="continue.html">continue</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The second does not advocate stopping either:</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="continue.html">continue</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># This is because the CI is too wide:</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="prob_tox_quantile.html">prob_tox_quantile</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.005596063 0.018576910 0.090744056 0.204717651 0.413022708</span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="prob_tox_quantile.html">prob_tox_quantile</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1509501 0.2337941 0.4168693 0.5608330 0.7243968</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># However, the third design advocates stopping because the CI at the</span></span></span>
<span class="r-in"><span><span class="co"># recommended dose is covered:</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="continue.html">continue</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="co"># To verify the veracity, inspect the quantiles:</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="prob_tox_quantile.html">prob_tox_quantile</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.005596063 0.018576910 0.090744056 0.204717651 0.413022708</span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="prob_tox_quantile.html">prob_tox_quantile</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1509501 0.2337941 0.4168693 0.5608330 0.7243968</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

