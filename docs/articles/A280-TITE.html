<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TITE-CRM and TITE-NBG - Time-to-Event Designs • escalation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TITE-CRM and TITE-NBG - Time-to-Event Designs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">escalation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A100-DoseSelectors.html">Using escalation</a>
    </li>
    <li>
      <a href="../articles/A205-CRM.html">CRM - Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/A207-NBG.html">NBG - Neuenschwander, Branson &amp; Gsponer</a>
    </li>
    <li>
      <a href="../articles/A210-TPI.html">TPI - Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A220-mTPI.html">mTPI - Modified Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A230-BOIN.html">BOIN - Bayesian Optimal Interval Design</a>
    </li>
    <li>
      <a href="../articles/A280-TITE.html">TITE-CRM and TITE-NBG - Time-to-Event Designs</a>
    </li>
    <li>
      <a href="../articles/A310-EfficacyToxicity.html">EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs</a>
    </li>
    <li>
      <a href="../articles/A360-Combinations.html">BOIN-COMB - Treatment Combination Designs</a>
    </li>
    <li>
      <a href="../articles/A600-DosePaths.html">Working with dose-paths</a>
    </li>
    <li>
      <a href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a>
    </li>
    <li>
      <a href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brockk/escalation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TITE-CRM and TITE-NBG - Time-to-Event
Designs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/HEAD/vignettes/A280-TITE.Rmd" class="external-link"><code>vignettes/A280-TITE.Rmd</code></a></small>
      <div class="hidden name"><code>A280-TITE.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="tite-crm">TITE-CRM<a class="anchor" aria-label="anchor" href="#tite-crm"></a>
</h3>
<p><span class="citation">Y. K. Cheung and Chappell (2000)</span>
introduced TITE-CRM as a variant of the regular CRM <span class="citation">(O’Quigley, Pepe, and Fisher 1990)</span> that handles
late-onset toxicities. Dose-finding trials tend to use a short toxicity
window after the commencement of therapy, during which each patient is
evaluated for the presence or absence of dose-limiting toxicity (DLT).
This approach works well in treatments like chemotherapy where toxic
reactions are expected to manifest relatively quickly. In contrast, one
of the hallmarks of radiotherapy, for instance, is that related adverse
reactions can manifest many months after the start of treatment. A
similar phenomenon may arise with immunotherapies.</p>
<p>In adaptive dose-finding clinical trials, where doses are selected
mid-trial in response to the outcomes experienced by patients evaluated
hitherto, late-onset toxic events present a distinct methodological
challenge. Naturally, the toxicity window will need to be long enough to
give the trial a good chance of observing events of interest. If,
however, we wait until each patient completes the evaluation window
before using their outcome to forecast the best dose, the trial may take
an infeasibly long time and ignore pertinent interim data.</p>
<p>TITE-CRM presents a solution by introducing the notion of a
<em>partial tolerance</em> event. If a patient is half way through the
evaluation window and has not yet experienced toxicity, we may say that
they have experienced half a tolerance. This simple novelty allows
partial information to be used in dose-recommendation decisions. If the
patient goes on to complete the window with no toxic reaction, they will
be regarded as having completely tolerated treatment, as is normally the
case with CRM and other dose-finding algorithms. This notion of partial
events is only applied to tolerances, however. If a patient experiences
toxicity at any point during the evaluation window, they are immediately
regarded as having experienced 100% of a DLT event.</p>
<p>To illustrate TITE-CRM mathematically, we start with the likelihood
from the plain vanilla CRM. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
be a random variable taking values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0, 1\}</annotation></semantics></math>
reflecting the absence and presence of DLT respectively in patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
A patient administered dose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
has estimated probability of toxicity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(x_i, \theta)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
represents the set of model parameters. The likelihood component arising
from patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Y</mi><mi>i</mi></msub></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex"> F(x_i, \theta)^{Y_i} (1 - F(x_i, \theta))^{1-Y_i} </annotation></semantics></math></p>
<p>and the aggregate likelihood after the evaluation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
patients is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">{</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><msub><mi>Y</mi><mi>i</mi></msub></msup><msup><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>−</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex"> L_J(\theta) = \prod_{i=1}^J \left\{ F(x_i, \theta) \right\}^{Y_i} \left\{ 1 - F(x_i, \theta) \right\}^{1-Y_i} </annotation></semantics></math></p>
<p><span class="citation">Y. K. Cheung and Chappell (2000)</span>
observed that each patient may provide a weight,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>,
reflecting the extend to which their outcome has been evaluated. The
weighted likelihood is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>J</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>J</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>w</mi><mi>i</mi></msub><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><msub><mi>Y</mi><mi>i</mi></msub></msup><msup><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>Y</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex"> L_J(\theta) = \prod_{i=1}^J \left\{ w_i F(x_i, \theta) \right\}^{Y_i} \left\{ 1 - w_i F(x_i, \theta) \right\}^{1-Y_i} </annotation></semantics></math></p>
<p>TITE-CRM weights the outcomes according to the extend to which
patients have completed the evaluation period. To illustrate the design,
we reproduce the example given on p.124 of <span class="citation">Ying
Kuen Cheung (2011)</span>. Four patients have been treated at dose-level
3 and all are part-way through the 126-day toxicity evaluation
window.</p>
<p>The authors use the empiric model so that there is one parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\theta = \beta</annotation></semantics></math>,
the dose-toxicity relation is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>x</mi><mi>i</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msubsup></mrow><annotation encoding="application/x-tex">F(x_i, \beta) = x_i^{exp(\beta)}</annotation></semantics></math>,
and a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>β</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, \sigma_{\beta}^2)</annotation></semantics></math>
prior is specified on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="tite-nbg">TITE-NBG<a class="anchor" aria-label="anchor" href="#tite-nbg"></a>
</h3>
<p><span class="citation">Neuenschwander, Branson, and Gsponer
(2008)</span> (NBG) introduced a derivative of the CRM for
dose-escalation clinical trials using a two-parameter model (see the NBG
vignette).</p>
<p>The authors did not introduce a time-to-event variant of their design
but it was simple to add one to <code>escalation</code> using the same
method presented above with a weight parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.
We demonstrate that method here alongside TITE-CRM.</p>
</div>
</div>
<div class="section level2">
<h2 id="implementation-in-escalation">Implementation in <code>escalation</code><a class="anchor" aria-label="anchor" href="#implementation-in-escalation"></a>
</h2>
<div class="section level3">
<h3 id="tite-crm-1">TITE-CRM<a class="anchor" aria-label="anchor" href="#tite-crm-1"></a>
</h3>
<p>As with the regular CRM, we require a dose-toxicity skeleton and a
target toxicity value. For illustration, we use the same parameters as
used in the plain CRM vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://brockk.github.io/escalation/" class="external-link">escalation</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">skeleton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.12</span>, <span class="fl">0.25</span>, <span class="fl">0.40</span>, <span class="fl">0.55</span><span class="op">)</span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">beta_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1.34</span><span class="op">)</span></span></code></pre></div>
<p><code>a0</code> is the fixed intercept value and <code>beta_sd</code>
is the SD of the slope parameter. We then have design:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm_tite.html">get_dfcrm_tite</a></span><span class="op">(</span></span>
<span>  skeleton <span class="op">=</span> <span class="va">skeleton</span>, </span>
<span>  target <span class="op">=</span> <span class="va">target</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>  intcpt <span class="op">=</span> <span class="va">a0</span>, </span>
<span>  scale <span class="op">=</span> <span class="va">beta_sd</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Elsewhere in <code>escalation</code>, we have represented outcomes
using character strings. The complexity of specifying patient-level
weights prevents that approach in time-to-event trials. Instead we
represent outcomes in data-frames. For example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  dose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  tox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.9</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  cohort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span></span>
<span><span class="co">#&gt;   dose tox weight cohort</span></span>
<span><span class="co">#&gt; 1    1   0    1.0      1</span></span>
<span><span class="co">#&gt; 2    1   0    1.0      2</span></span>
<span><span class="co">#&gt; 3    2   0    1.0      3</span></span>
<span><span class="co">#&gt; 4    2   0    0.9      4</span></span>
<span><span class="co">#&gt; 5    3   1    1.0      5</span></span>
<span><span class="co">#&gt; 6    3   0    0.5      6</span></span></code></pre></div>
<p>represents a scenario where we have sequentially had two patients
each at dose-levels 1, 2 and 3. The first three patients have been fully
evaluated as tolerating treatment (their <code>tox</code> parameters are
0 and their <code>weight</code> parameters are 1). The fifth patient is
also fully-weighted because they unfortunately experienced toxicity
(their <code>tox</code> parameter is 1 and their <code>weight</code>
parameter is also 1). Finally, the fourth and sixth patients are still
being evaluated without having experienced toxicity so far (their
<code>tox</code> parameters are 0 and their <code>weight</code>
parameters are less than 1).</p>
<p>To fit the model to these outcomes, we run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<p>The usual generic functions apply:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Patient-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   Patient Cohort  Dose   Tox Weight</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1      1     1     0    1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2      2     1     0    1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3      3     2     0    1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4      4     2     0    0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5      5     3     1    1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6      6     3     0    0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dose-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   dose     tox     n empiric_tox_rate mean_prob_tox median_prob_tox admissible</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NoDose     0     0              0          0               0      TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1          0     2              0          0.074<span style="text-decoration: underline;">8</span>          0.074<span style="text-decoration: underline;">8</span> TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2          0     2              0          0.164           0.164  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 3          1     2              0.5        0.310           0.310  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 4          0     0            <span style="color: #BB0000;">NaN</span>          0.460           0.460  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5          0     0            <span style="color: #BB0000;">NaN</span>          0.599           0.599  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: recommended &lt;lgl&gt;, Skeleton &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model targets a toxicity level of 0.25.</span></span>
<span><span class="co">#&gt; The model advocates continuing at dose 3.</span></span></code></pre></div>
<p>Note the <code>Weight</code> columns in the patient-level output.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tite-nbg-1">TITE-NBG<a class="anchor" aria-label="anchor" href="#tite-nbg-1"></a>
</h3>
<p>Let us reuse the design presented and justified by <span class="citation">Neuenschwander, Branson, and Gsponer (2008)</span> and
demonstrated in the NBG vignette:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">200</span>, <span class="fl">250</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trialr_nbg_tite.html">get_trialr_nbg_tite</a></span><span class="op">(</span></span>
<span>  real_doses <span class="op">=</span> <span class="va">dose</span>, d_star <span class="op">=</span> <span class="fl">250</span>, target <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  alpha_mean <span class="op">=</span> <span class="fl">2.15</span>, alpha_sd <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>  beta_mean <span class="op">=</span> <span class="fl">0.52</span>, beta_sd <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">2020</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To fit the model to the outcomes from the TITE-CRM example, we
run:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<p>The usual generic functions apply:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Patient-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   Patient Cohort  Dose   Tox    Weight</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl[1d]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1      1     1     0       1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2      2     1     0       1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3      3     2     0       1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4      4     2     0       0.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5      5     3     1       1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6      6     3     0       0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dose-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 9</span></span></span>
<span><span class="co">#&gt;    dose     tox     n empiric_tox_rate mean_prob_tox median_prob_tox admissible</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> NoDose     0     0              0          0               0      TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1          0     2              0          0.096<span style="text-decoration: underline;">9</span>          0.058<span style="text-decoration: underline;">5</span> TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2          0     2              0          0.163           0.125  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 3          1     2              0.5        0.241           0.213  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 4          0     0            <span style="color: #BB0000;">NaN</span>          0.346           0.335  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 5          0     0            <span style="color: #BB0000;">NaN</span>          0.420           0.419  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6          0     0            <span style="color: #BB0000;">NaN</span>          0.476           0.483  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 7          0     0            <span style="color: #BB0000;">NaN</span>          0.522           0.534  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 8          0     0            <span style="color: #BB0000;">NaN</span>          0.559           0.573  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 9          0     0            <span style="color: #BB0000;">NaN</span>          0.618           0.636  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 10         0     0            <span style="color: #BB0000;">NaN</span>          0.662           0.681  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 11         0     0            <span style="color: #BB0000;">NaN</span>          0.735           0.757  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 12         0     0            <span style="color: #BB0000;">NaN</span>          0.781           0.804  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 13         0     0            <span style="color: #BB0000;">NaN</span>          0.834           0.858  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 14         0     0            <span style="color: #BB0000;">NaN</span>          0.865           0.889  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 15         0     0            <span style="color: #BB0000;">NaN</span>          0.885           0.908  TRUE      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: recommended &lt;lgl&gt;, RealDose &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model targets a toxicity level of 0.3.</span></span>
<span><span class="co">#&gt; The model advocates continuing at dose 4.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dose-paths">Dose paths<a class="anchor" aria-label="anchor" href="#dose-paths"></a>
</h3>
<p>Dose-paths do not make sense for time-to-event designs because there
are practically infinite trial states once continuous patient-level
weights are considered. Dose-paths are not implemented.</p>
</div>
<div class="section level3">
<h3 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_prob_tox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.35</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p>For the sake of speed, we will run just a few iterations:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_sims</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></code></pre></div>
<p>In real life, however, we would naturally run many iterations.</p>
<p>Let us restrict the design to a sample size of 12 for a quick
illustration. Running the simulation:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm_tite.html">get_dfcrm_tite</a></span><span class="op">(</span></span>
<span>  skeleton <span class="op">=</span> <span class="va">skeleton</span>, </span>
<span>  target <span class="op">=</span> <span class="va">target</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"logistic"</span>, </span>
<span>  intcpt <span class="op">=</span> <span class="va">a0</span>, </span>
<span>  scale <span class="op">=</span> <span class="va">beta_sd</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span></span>
<span>    num_sims <span class="op">=</span> <span class="va">num_sims</span>, </span>
<span>    true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>    max_time <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>we see that from this small sample size that the low doses are most
likely to be recommended:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prob_recommend.html">prob_recommend</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt; NoDose      1      2      3      4      5 </span></span>
<span><span class="co">#&gt;   0.00   0.75   0.20   0.05   0.00   0.00</span></span></code></pre></div>
<p>with most patients treated at low dose-levels too:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="../reference/n_at_dose.html">n_at_dose</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 9.70 0.15 1.40 0.55 0.20</span></span></code></pre></div>
<p>The simulated trial durations could be of interest in a time-to-event
trial:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trial_duration.html">trial_duration</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 19.64932 17.92124 20.81784 20.33176 19.79155 19.20623 24.85348 23.14870</span></span>
<span><span class="co">#&gt;  [9] 17.31764 23.62735 23.21265 18.13445 23.99437 21.26878 20.89885 20.28926</span></span>
<span><span class="co">#&gt; [17] 24.72482 28.22818 23.73679 26.39005</span></span></code></pre></div>
<p>The <code>max_time</code> parameter was specified so that the design
could calculate the patient-level weights (i.e. how much of the
observation window had been completed). In the above example, patients
were assumed to arrive one at a time with the intra-patient arrival
times distributed by an Exponential(1) distribution; this is the
default. To override that, we specify a function in the
<code>sample_patient_arrivals</code> parameter. The function must take
the patient-level data-frame of the prevailing trial data as a parameter
(i.e. with columns <code>cohort</code>, <code>patient</code>,
<code>dose</code>, <code>tox</code>, and <code>time</code>), and return
a data-frame with column <code>time_delta</code> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
rows containing the arrival deltas of the next
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
patients. For example, consider that you want to evaluate patients in
cohorts of two. This is somewhat strange because a time-to-event design
frees you from the obligation to use cohorts, but it is simple to
implement. We could run:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span></span>
<span>    num_sims <span class="op">=</span> <span class="va">num_sims</span>, </span>
<span>    true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>    max_time <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    sample_patient_arrivals <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="../reference/cohorts_of_n.html">cohorts_of_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, mean_time_delta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    return_all_fits <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Note: the <code>return_all_fits = TRUE</code> param means that every
model fit (all interims and final fits) are returned. We use it here to
peak into the way simulations occur. However, in a production run with a
large number of iterates and many patients, doing this could lead to
memory problems. By default, <code>return_all_fits</code> is
<code>FALSE</code>.</p>
<p>The patient arrival times for the (for instance) third simulated
trial iterate are random and always increasing:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'purrr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     set_names</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">sims</span><span class="op">$</span><span class="va">fits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  0.000000  1.158482  2.835637  4.883962  7.830599  9.916354 10.534122</span></span>
<span><span class="co">#&gt; [8] 20.534122</span></span></code></pre></div>
<p>However, the doses given (patients in columns, simulated iterates in
rows) appear in pairs to reflect that patients were treated in cohorts
of two:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/doses_given.html">doses_given</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]</span></span>
<span><span class="co">#&gt;  [1,]    1    1    3    3    4    4    5    5    3     3     3     3</span></span>
<span><span class="co">#&gt;  [2,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [3,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [4,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [5,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [6,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [7,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [8,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt;  [9,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [10,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [11,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [12,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [13,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [14,]    1    1    3    3    4    4    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [15,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [16,]    1    1    1    1    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [17,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [18,]    1    1    4    4    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [19,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span>
<span><span class="co">#&gt; [20,]    1    1    3    3    1    1    1    1    1     1     1     1</span></span></code></pre></div>
<p>The inclusion of <code>df</code> as a parameter in the call to
<code>sample_patient_arrivals</code> lets you tailor the patient arrival
process in many creative ways, including variable cohort sizes, minimum
intra-patient gaps, etc.</p>
<p>For more information on running dose-finding simulations, refer to
the simulation vignette.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cheung2000" class="csl-entry">
Cheung, Y K, and R Chappell. 2000. <span>“<a href="https://www.ncbi.nlm.nih.gov/pubmed/11129476" class="external-link">Sequential Designs
for Phase <span>I</span> Clinical Trials with Late-Onset
Toxicities.</a>”</span> <em>Biometrics</em> 56 (4): 1177–82.
</div>
<div id="ref-Cheung2011" class="csl-entry">
Cheung, Ying Kuen. 2011. <em>Dose <span>Finding</span> by the
<span>Continual Reassessment Method</span></em>. New York: <span>Chapman
&amp; Hall / CRC Press</span>.
</div>
<div id="ref-Neuenschwander2008" class="csl-entry">
Neuenschwander, Beat, Michael Branson, and Thomas Gsponer. 2008.
<span>“<span class="nocase">Critical aspects of the Bayesian approach to
phase I cancer trials</span>.”</span> <em>Statistics in Medicine</em>
27: 2420–39. <a href="https://doi.org/10.1002/sim.3230" class="external-link">https://doi.org/10.1002/sim.3230</a>.
</div>
<div id="ref-OQuigley1990" class="csl-entry">
O’Quigley, J, M Pepe, and L Fisher. 1990. <span>“Continual Reassessment
Method: A Practical Design for Phase 1 Clinical Trials in
Cancer.”</span> <em>Biometrics</em> 46 (1): 33–48. <a href="https://doi.org/10.2307/2531628" class="external-link">https://doi.org/10.2307/2531628</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
