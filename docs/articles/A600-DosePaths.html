<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with dose-paths • escalation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with dose-paths">
<meta property="og:description" content="escalation">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">escalation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A100-DoseSelectors.html">Using escalation</a>
    </li>
    <li>
      <a href="../articles/A205-CRM.html">Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/A207-NBG.html">Neuenschwander, Branson &amp; Gsponer</a>
    </li>
    <li>
      <a href="../articles/A210-TPI.html">Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A220-mTPI.html">Modified Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A230-BOIN.html">Bayesian Optimal Interval Design</a>
    </li>
    <li>
      <a href="../articles/A600-DosePaths.html">Working with dose-paths</a>
    </li>
    <li>
      <a href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a>
    </li>
    <li>
      <a href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brockk/escalation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="A600-DosePaths_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="A600-DosePaths_files/viz-1.8.2/viz.js"></script><link href="A600-DosePaths_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="A600-DosePaths_files/grViz-binding-1.0.10/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Working with dose-paths</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/HEAD/vignettes/A600-DosePaths.Rmd" class="external-link"><code>vignettes/A600-DosePaths.Rmd</code></a></small>
      <div class="hidden name"><code>A600-DosePaths.Rmd</code></div>

    </div>

    
    
<p>The <code>escalation</code> package by Kristian Brock. Documentation
is hosted at <a href="https://brockk.github.io/escalation/" class="external-link uri">https://brockk.github.io/escalation/</a></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Dose-finding clinical trials investigate experimental agents, seeking
doses that are tolerable and active. They commonly use some
dose-selection model to analyse binary outcomes at increasing doses in
cohorts of patients. It is possible to analyse the behaviour of a
dose-finding design by exhaustively calculating every possible set of
outcomes and invoking the dose selection model on each. We will refer to
these hypothetical sequences of doses in response to outcomes as
<em>dose-paths</em>.</p>
<p>An example will make this clear. The 3+3 design is widely understood.
One of its benefits is its simplicity. Let us investigate the first two
cohorts of three patients in the 3+3 variant that permits de-escalation.
We calculate dose-paths in <code>escalation</code> using the
<code>get_dose_paths</code> function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://brockk.github.io/escalation/" class="external-link">escalation</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: magrittr</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_three_plus_three.html">get_three_plus_three</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">5</span>, allow_deescalate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>get_dose_paths</code> takes a dose-selection methodology and
enumerates every possible path according to the cohort sizes that you
specify. The returned <code>paths</code> object contains lot of
information but the most pertinent perhaps is the sequence of
dose-recommendations in response to hypothetical outcomes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span></span>
<span><span class="co">#&gt; Give dose 1: </span></span>
<span><span class="co">#&gt;   NNN -&gt; 2 </span></span>
<span><span class="co">#&gt;     NNN -&gt; 3 </span></span>
<span><span class="co">#&gt;     NNT -&gt; 2 </span></span>
<span><span class="co">#&gt;     NTT -&gt; 1 </span></span>
<span><span class="co">#&gt;     TTT -&gt; 1 </span></span>
<span><span class="co">#&gt;   NNT -&gt; 1 </span></span>
<span><span class="co">#&gt;     NNN -&gt; 2 </span></span>
<span><span class="co">#&gt;     NNT -&gt; NA </span></span>
<span><span class="co">#&gt;     NTT -&gt; NA </span></span>
<span><span class="co">#&gt;     TTT -&gt; NA </span></span>
<span><span class="co">#&gt;   NTT -&gt; NA </span></span>
<span><span class="co">#&gt;   TTT -&gt; NA</span></span></code></pre></div>
<p>We see above that the trial starts at dose 1. If three non-toxicities
(N) are seen, the algorithm advocates escalation to dose 2. In constrast
if two or more toxicities (T) are seen in the first cohort, no dose is
selected (the dose is <code>NA</code>) and the trial stops. Subsequent
cohorts are represented by greater levels of indentation.</p>
<p>This information is better represented by a graph. If you are using
RStudio, the graph will appear in the <em>Viewer</em> pane. (In this
vignette, we suppress non-RStudio demonstration of the graphs to avoid
problems on CRAN computers.)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-459d0aee1a4dd002c55a" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-459d0aee1a4dd002c55a">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#7AD151FF\", fillcolor = \"#414487FF\"] \n  \"2\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#2A788EFF\"] \n  \"3\" [label = \"3\", fontcolor = \"#440154FF\", fillcolor = \"#22A884FF\"] \n  \"4\" [label = \"1\", fontcolor = \"#7AD151FF\", fillcolor = \"#414487FF\"] \n  \"5\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#2A788EFF\"] \n  \"6\" [label = \"Stop\", fontcolor = \"#22A884FF\", fillcolor = \"#440154FF\"] \n  \"7\" [label = \"Stop\", fontcolor = \"#22A884FF\", fillcolor = \"#440154FF\"] \n  \"8\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#2A788EFF\"] \n  \"9\" [label = \"Stop\", fontcolor = \"#22A884FF\", fillcolor = \"#440154FF\"] \n  \"10\" [label = \"1\", fontcolor = \"#7AD151FF\", fillcolor = \"#414487FF\"] \n  \"11\" [label = \"Stop\", fontcolor = \"#22A884FF\", fillcolor = \"#440154FF\"] \n  \"12\" [label = \"1\", fontcolor = \"#7AD151FF\", fillcolor = \"#414487FF\"] \n  \"13\" [label = \"Stop\", fontcolor = \"#22A884FF\", fillcolor = \"#440154FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"1\"->\"7\" [label = \"TTT\"] \n\"2\"->\"8\" [label = \"NNT\"] \n\"4\"->\"9\" [label = \"NNT\"] \n\"2\"->\"10\" [label = \"NTT\"] \n\"4\"->\"11\" [label = \"NTT\"] \n\"2\"->\"12\" [label = \"TTT\"] \n\"4\"->\"13\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The blue node towards the centre bearing the number <code>1</code>
represents the start of the trial. The edges of the graph (the lines
connecting the nodes) represent the outcomes in cohorts of patients. As
before, we see that if three <code>N</code> events are seen, the trial
escalates to dose 2. Three patients are assumed to be treated at that
dose and from there, further escalation to dose 3 will be advised if no
toxicity is seen. In contrast, dose 2 will be retained for a further
cohort of three if a single toxicity is seen, and de-escalation to dose
1 will occur if two or more toxicities are seen. This is exactly the
behaviour we expect from the 3+3 design.</p>
<p>Dose-paths were introduced in the phase I setting that we consider
here by <span class="citation">Yap et al. (2017)</span>. Their phase
I/II analogue was introduced by <span class="citation">Brock et al.
(2017)</span> for dose-finding trials that consider efficacy and
toxicity outcomes.</p>
</div>
<div class="section level2">
<h2 id="other-models">Other Models<a class="anchor" aria-label="anchor" href="#other-models"></a>
</h2>
<div class="section level3">
<h3 id="crm">CRM<a class="anchor" aria-label="anchor" href="#crm"></a>
</h3>
<p>The above example uses the 3+3 design but other methods are
available. In fact, early phase statisticians would much prefer that you
use a model-based method <span class="citation">(Wheeler et al.
2019)</span>. The <code>escalation</code> package is intentionally
written so that all dose selectors look the same, regardless the
implementation-level details. In computing terminology, dose selectors
in <code>escalation</code> support a common interface. This makes it
trivial to calculate dose-paths for all dose-selectors - we just use the
<code>get_dose_paths</code> function again.</p>
<p>Let us investigate a continual reassessment method (CRM) design now,
as described by <span class="citation">O’Quigley, Pepe, and Fisher
(1990)</span> and implemented by the dfcrm package <span class="citation">(Cheung 2013)</span>. We must specify a dose-toxicity
skeleton, and a target toxicity level:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">skeleton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></code></pre></div>
<p>We can then specify a CRM model and calculate dose-paths as
before:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When we graph the paths this time (and adopt a different colour
palette for fun):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, viridis_palette <span class="op">=</span> <span class="st">'magma'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-bff7b1c5ae96336fca30" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-bff7b1c5ae96336fca30">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"2\" [label = \"4\", fontcolor = \"#3B0F70FF\", fillcolor = \"#FE9F6DFF\"] \n  \"3\" [label = \"5\", fontcolor = \"#8C2981FF\", fillcolor = \"#FCFDBFFF\"] \n  \"4\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"5\" [label = \"2\", fontcolor = \"#FCFDBFFF\", fillcolor = \"#8C2981FF\"] \n  \"6\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"7\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"8\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"9\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"10\" [label = \"3\", fontcolor = \"#000004FF\", fillcolor = \"#DE4968FF\"] \n  \"11\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"12\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"13\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"14\" [label = \"2\", fontcolor = \"#FCFDBFFF\", fillcolor = \"#8C2981FF\"] \n  \"15\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"16\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"17\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"18\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"19\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"20\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n  \"21\" [label = \"1\", fontcolor = \"#FE9F6DFF\", fillcolor = \"#3B0F70FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"8\"->\"9\" [label = \"NNN\"] \n\"2\"->\"10\" [label = \"NNT\"] \n\"4\"->\"11\" [label = \"NNT\"] \n\"6\"->\"12\" [label = \"NNT\"] \n\"8\"->\"13\" [label = \"NNT\"] \n\"2\"->\"14\" [label = \"NTT\"] \n\"4\"->\"15\" [label = \"NTT\"] \n\"6\"->\"16\" [label = \"NTT\"] \n\"8\"->\"17\" [label = \"NTT\"] \n\"2\"->\"18\" [label = \"TTT\"] \n\"4\"->\"19\" [label = \"TTT\"] \n\"6\"->\"20\" [label = \"TTT\"] \n\"8\"->\"21\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>we see that the <code>Stop</code> node is absent - all paths
recommend a dose, even those seeing substaantial toxicity. Stopping
behaviours must be specified for the CRM method. Fortunately,
<code>escalation</code> makes this simple.</p>
<p>An intuitive method for stopping in the Bayesian setting is to test
the posterior distribution for the probability of toxicity. In our
example, we will stop if there is at least a 90% probability that the
toxicity rate at the lowest dose is 35% or greater:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stop_when_too_toxic.html">stop_when_too_toxic</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">1</span>, tox_threshold <span class="op">=</span> <span class="fl">0.35</span>, confidence <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When we visualise the paths from the updated model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, viridis_palette <span class="op">=</span> <span class="st">'inferno'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-24e4a95322cc70d0d9a5" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-24e4a95322cc70d0d9a5">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"2\" [label = \"4\", fontcolor = \"#420A68FF\", fillcolor = \"#FCA50AFF\"] \n  \"3\" [label = \"5\", fontcolor = \"#932667FF\", fillcolor = \"#FCFFA4FF\"] \n  \"4\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"5\" [label = \"2\", fontcolor = \"#FCFFA4FF\", fillcolor = \"#932667FF\"] \n  \"6\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"7\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"8\" [label = \"Stop\", fontcolor = \"#DD513AFF\", fillcolor = \"#000004FF\"] \n  \"9\" [label = \"3\", fontcolor = \"#000004FF\", fillcolor = \"#DD513AFF\"] \n  \"10\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"11\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"12\" [label = \"2\", fontcolor = \"#FCFFA4FF\", fillcolor = \"#932667FF\"] \n  \"13\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"14\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"15\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"16\" [label = \"1\", fontcolor = \"#FCA50AFF\", fillcolor = \"#420A68FF\"] \n  \"17\" [label = \"Stop\", fontcolor = \"#DD513AFF\", fillcolor = \"#000004FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"2\"->\"9\" [label = \"NNT\"] \n\"4\"->\"10\" [label = \"NNT\"] \n\"6\"->\"11\" [label = \"NNT\"] \n\"2\"->\"12\" [label = \"NTT\"] \n\"4\"->\"13\" [label = \"NTT\"] \n\"6\"->\"14\" [label = \"NTT\"] \n\"2\"->\"15\" [label = \"TTT\"] \n\"4\"->\"16\" [label = \"TTT\"] \n\"6\"->\"17\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>we see that some paths once again recommend stopping. The paths that
recommend a dose are otherwise unchanged.</p>
</div>
<div class="section level3">
<h3 id="boin">BOIN<a class="anchor" aria-label="anchor" href="#boin"></a>
</h3>
<p>Another dose-escalation model implemented in <code>escalation</code>
is the Bayesian optimal interval (BOIN) method by <span class="citation">Liu and Yuan (2015)</span>, implemented in the
<code>BOIN</code> package <span class="citation">(Yuan and Liu
2018)</span>.</p>
<p>To spice things up, we will visualise how this model behaves over
four cohorts of two patients:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin.html">get_boin</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">4</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 121 model evaluations. Be patient.</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, RColorBrewer_palette <span class="op">=</span> <span class="st">'YlOrRd'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-45b44a26c0f5848627b0" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-45b44a26c0f5848627b0">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"2\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"3\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"4\" [label = \"4\", fontcolor = \"#FECC5C\", fillcolor = \"#BD0026\"] \n  \"5\" [label = \"4\", fontcolor = \"#FECC5C\", fillcolor = \"#BD0026\"] \n  \"6\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"7\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"8\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"9\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"10\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"11\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"12\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"13\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"14\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"15\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"16\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"17\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"18\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"19\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"20\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"21\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"22\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"23\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"24\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"25\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"26\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"27\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"28\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"29\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"30\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"31\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"32\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"33\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"34\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"35\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"36\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"37\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"38\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"39\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"40\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"41\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"42\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"43\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"44\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"45\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"46\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"47\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"48\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"49\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"50\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"51\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"52\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"53\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"54\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"55\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"56\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"57\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"58\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"59\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"60\" [label = \"2\", fontcolor = \"#BD0026\", fillcolor = \"#FD8D3C\"] \n  \"61\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"62\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"63\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"64\" [label = \"3\", fontcolor = \"#FFFFB2\", fillcolor = \"#F03B20\"] \n  \"65\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"66\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"67\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"68\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"69\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"70\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"71\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"72\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"73\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"74\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"75\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"76\" [label = \"1\", fontcolor = \"#F03B20\", fillcolor = \"#FECC5C\"] \n  \"77\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"78\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n  \"79\" [label = \"Stop\", fontcolor = \"#FD8D3C\", fillcolor = \"#FFFFB2\"] \n\"1\"->\"2\" [label = \"NN\"] \n\"2\"->\"3\" [label = \"NN\"] \n\"3\"->\"4\" [label = \"NN\"] \n\"4\"->\"5\" [label = \"NN\"] \n\"1\"->\"6\" [label = \"NT\"] \n\"6\"->\"7\" [label = \"NN\"] \n\"7\"->\"8\" [label = \"NN\"] \n\"8\"->\"9\" [label = \"NN\"] \n\"1\"->\"10\" [label = \"TT\"] \n\"10\"->\"11\" [label = \"NN\"] \n\"11\"->\"12\" [label = \"NN\"] \n\"12\"->\"13\" [label = \"NN\"] \n\"2\"->\"14\" [label = \"NT\"] \n\"14\"->\"15\" [label = \"NN\"] \n\"15\"->\"16\" [label = \"NN\"] \n\"6\"->\"17\" [label = \"NT\"] \n\"17\"->\"18\" [label = \"NN\"] \n\"18\"->\"19\" [label = \"NN\"] \n\"10\"->\"20\" [label = \"NT\"] \n\"2\"->\"21\" [label = \"TT\"] \n\"21\"->\"22\" [label = \"NN\"] \n\"22\"->\"23\" [label = \"NN\"] \n\"6\"->\"24\" [label = \"TT\"] \n\"10\"->\"25\" [label = \"TT\"] \n\"3\"->\"26\" [label = \"NT\"] \n\"26\"->\"27\" [label = \"NN\"] \n\"7\"->\"28\" [label = \"NT\"] \n\"28\"->\"29\" [label = \"NN\"] \n\"11\"->\"30\" [label = \"NT\"] \n\"30\"->\"31\" [label = \"NN\"] \n\"14\"->\"32\" [label = \"NT\"] \n\"32\"->\"33\" [label = \"NN\"] \n\"17\"->\"34\" [label = \"NT\"] \n\"34\"->\"35\" [label = \"NN\"] \n\"21\"->\"36\" [label = \"NT\"] \n\"36\"->\"37\" [label = \"NN\"] \n\"3\"->\"38\" [label = \"TT\"] \n\"38\"->\"39\" [label = \"NN\"] \n\"7\"->\"40\" [label = \"TT\"] \n\"40\"->\"41\" [label = \"NN\"] \n\"11\"->\"42\" [label = \"TT\"] \n\"14\"->\"43\" [label = \"TT\"] \n\"43\"->\"44\" [label = \"NN\"] \n\"17\"->\"45\" [label = \"TT\"] \n\"21\"->\"46\" [label = \"TT\"] \n\"46\"->\"47\" [label = \"NN\"] \n\"4\"->\"48\" [label = \"NT\"] \n\"8\"->\"49\" [label = \"NT\"] \n\"12\"->\"50\" [label = \"NT\"] \n\"15\"->\"51\" [label = \"NT\"] \n\"18\"->\"52\" [label = \"NT\"] \n\"22\"->\"53\" [label = \"NT\"] \n\"26\"->\"54\" [label = \"NT\"] \n\"28\"->\"55\" [label = \"NT\"] \n\"30\"->\"56\" [label = \"NT\"] \n\"32\"->\"57\" [label = \"NT\"] \n\"34\"->\"58\" [label = \"NT\"] \n\"36\"->\"59\" [label = \"NT\"] \n\"38\"->\"60\" [label = \"NT\"] \n\"40\"->\"61\" [label = \"NT\"] \n\"43\"->\"62\" [label = \"NT\"] \n\"46\"->\"63\" [label = \"NT\"] \n\"4\"->\"64\" [label = \"TT\"] \n\"8\"->\"65\" [label = \"TT\"] \n\"12\"->\"66\" [label = \"TT\"] \n\"15\"->\"67\" [label = \"TT\"] \n\"18\"->\"68\" [label = \"TT\"] \n\"22\"->\"69\" [label = \"TT\"] \n\"26\"->\"70\" [label = \"TT\"] \n\"28\"->\"71\" [label = \"TT\"] \n\"30\"->\"72\" [label = \"TT\"] \n\"32\"->\"73\" [label = \"TT\"] \n\"34\"->\"74\" [label = \"TT\"] \n\"36\"->\"75\" [label = \"TT\"] \n\"38\"->\"76\" [label = \"TT\"] \n\"40\"->\"77\" [label = \"TT\"] \n\"43\"->\"78\" [label = \"TT\"] \n\"46\"->\"79\" [label = \"TT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The first thing to note about the graph above is that it is much more
complex than the previous graphs. The number of nodes in dose-paths
increases faster than linearly as more cohorts are considered.
Consideration of this must be given when visualising dose-paths.</p>
<p>Secondly, the visual method makes it simple to discern messages about
future model behaviour. For instance, we can easily see that dose 4, the
darkest red node, is only reached in the first four cohorts if the first
cohort sees no toxicity.</p>
<p>In contrast to CRM, BOIN does have a stopping rule for excess
toxicity built in. We see that <code>TT</code> in the first cohort is
not enough to advocate stopping but that any further toxicity in the
second cohort will be sufficient to warrant stopping.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-options">Further options<a class="anchor" aria-label="anchor" href="#further-options"></a>
</h2>
<div class="section level3">
<h3 id="non-uniform-cohorts">Non-uniform cohorts<a class="anchor" aria-label="anchor" href="#non-uniform-cohorts"></a>
</h3>
<p>There is no reason that the cohort sizes should be uniform. Specify
whatever <code>cohort_sizes</code> you like:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin.html">get_boin</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">4</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, RColorBrewer_palette <span class="op">=</span> <span class="st">'Blues'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c65804de603f112d72f8" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-c65804de603f112d72f8">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"2\" [label = \"2\", fontcolor = \"#08519C\", fillcolor = \"#6BAED6\"] \n  \"3\" [label = \"3\", fontcolor = \"#EFF3FF\", fillcolor = \"#3182BD\"] \n  \"4\" [label = \"4\", fontcolor = \"#BDD7E7\", fillcolor = \"#08519C\"] \n  \"5\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"6\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"7\" [label = \"2\", fontcolor = \"#08519C\", fillcolor = \"#6BAED6\"] \n  \"8\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"9\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"10\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"11\" [label = \"Stop\", fontcolor = \"#6BAED6\", fillcolor = \"#EFF3FF\"] \n  \"12\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"13\" [label = \"2\", fontcolor = \"#08519C\", fillcolor = \"#6BAED6\"] \n  \"14\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"15\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"16\" [label = \"Stop\", fontcolor = \"#6BAED6\", fillcolor = \"#EFF3FF\"] \n  \"17\" [label = \"2\", fontcolor = \"#08519C\", fillcolor = \"#6BAED6\"] \n  \"18\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"19\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"20\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"21\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"22\" [label = \"2\", fontcolor = \"#08519C\", fillcolor = \"#6BAED6\"] \n  \"23\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"24\" [label = \"Stop\", fontcolor = \"#6BAED6\", fillcolor = \"#EFF3FF\"] \n  \"25\" [label = \"1\", fontcolor = \"#3182BD\", fillcolor = \"#BDD7E7\"] \n  \"26\" [label = \"Stop\", fontcolor = \"#6BAED6\", fillcolor = \"#EFF3FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"N\"] \n\"3\"->\"4\" [label = \"NN\"] \n\"1\"->\"5\" [label = \"NNT\"] \n\"5\"->\"6\" [label = \"N\"] \n\"6\"->\"7\" [label = \"NN\"] \n\"1\"->\"8\" [label = \"NTT\"] \n\"8\"->\"9\" [label = \"N\"] \n\"9\"->\"10\" [label = \"NN\"] \n\"1\"->\"11\" [label = \"TTT\"] \n\"2\"->\"12\" [label = \"T\"] \n\"12\"->\"13\" [label = \"NN\"] \n\"5\"->\"14\" [label = \"T\"] \n\"14\"->\"15\" [label = \"NN\"] \n\"8\"->\"16\" [label = \"T\"] \n\"3\"->\"17\" [label = \"NT\"] \n\"6\"->\"18\" [label = \"NT\"] \n\"9\"->\"19\" [label = \"NT\"] \n\"12\"->\"20\" [label = \"NT\"] \n\"14\"->\"21\" [label = \"NT\"] \n\"3\"->\"22\" [label = \"TT\"] \n\"6\"->\"23\" [label = \"TT\"] \n\"9\"->\"24\" [label = \"TT\"] \n\"12\"->\"25\" [label = \"TT\"] \n\"14\"->\"26\" [label = \"TT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>You can even evaluate the dose advice after each patient using cohort
sizes of 1:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin.html">get_boin</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">4</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, RColorBrewer_palette <span class="op">=</span> <span class="st">'RdPu'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2a805ad448482dbef514" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-2a805ad448482dbef514">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"2\" [label = \"2\", fontcolor = \"#7A0177\", fillcolor = \"#F768A1\"] \n  \"3\" [label = \"3\", fontcolor = \"#FEEBE2\", fillcolor = \"#C51B8A\"] \n  \"4\" [label = \"4\", fontcolor = \"#FBB4B9\", fillcolor = \"#7A0177\"] \n  \"5\" [label = \"4\", fontcolor = \"#FBB4B9\", fillcolor = \"#7A0177\"] \n  \"6\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"7\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"8\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"9\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"10\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"11\" [label = \"2\", fontcolor = \"#7A0177\", fillcolor = \"#F768A1\"] \n  \"12\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"13\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"14\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"15\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"16\" [label = \"2\", fontcolor = \"#7A0177\", fillcolor = \"#F768A1\"] \n  \"17\" [label = \"3\", fontcolor = \"#FEEBE2\", fillcolor = \"#C51B8A\"] \n  \"18\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"19\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"20\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"21\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"22\" [label = \"Stop\", fontcolor = \"#F768A1\", fillcolor = \"#FEEBE2\"] \n  \"23\" [label = \"3\", fontcolor = \"#FEEBE2\", fillcolor = \"#C51B8A\"] \n  \"24\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"25\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"26\" [label = \"Stop\", fontcolor = \"#F768A1\", fillcolor = \"#FEEBE2\"] \n  \"27\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n  \"28\" [label = \"Stop\", fontcolor = \"#F768A1\", fillcolor = \"#FEEBE2\"] \n  \"29\" [label = \"1\", fontcolor = \"#C51B8A\", fillcolor = \"#FBB4B9\"] \n\"1\"->\"2\" [label = \"N\"] \n\"2\"->\"3\" [label = \"N\"] \n\"3\"->\"4\" [label = \"N\"] \n\"4\"->\"5\" [label = \"N\"] \n\"1\"->\"6\" [label = \"T\"] \n\"6\"->\"7\" [label = \"N\"] \n\"7\"->\"8\" [label = \"N\"] \n\"8\"->\"9\" [label = \"N\"] \n\"2\"->\"10\" [label = \"T\"] \n\"10\"->\"11\" [label = \"N\"] \n\"11\"->\"12\" [label = \"N\"] \n\"6\"->\"13\" [label = \"T\"] \n\"13\"->\"14\" [label = \"N\"] \n\"14\"->\"15\" [label = \"N\"] \n\"3\"->\"16\" [label = \"T\"] \n\"16\"->\"17\" [label = \"N\"] \n\"7\"->\"18\" [label = \"T\"] \n\"18\"->\"19\" [label = \"N\"] \n\"10\"->\"20\" [label = \"T\"] \n\"20\"->\"21\" [label = \"N\"] \n\"13\"->\"22\" [label = \"T\"] \n\"4\"->\"23\" [label = \"T\"] \n\"8\"->\"24\" [label = \"T\"] \n\"11\"->\"25\" [label = \"T\"] \n\"14\"->\"26\" [label = \"T\"] \n\"16\"->\"27\" [label = \"T\"] \n\"18\"->\"28\" [label = \"T\"] \n\"20\"->\"29\" [label = \"T\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="partially-completed-trials">Partially completed trials<a class="anchor" aria-label="anchor" href="#partially-completed-trials"></a>
</h3>
<p>It is possible to calculate dose-paths from trials that are partially
completed. For instance, let us continue with our BOIN model and assume
that we have seen outcomes <code>1NNN 2TNT</code> so far in our trial.
Thus, we are reasonably sure that dose 1 is safe but wary that dose 2
might be too toxic. However, these beliefs are tempered by the tiny
sample size. From this starting point, how might the next two cohorts of
three proceed? We just specify the previous outcomes using the
<code>previous_outcomes</code> parameter:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin.html">get_boin</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">4</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, previous_outcomes <span class="op">=</span> <span class="st">'1NNN 2TNT'</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, viridis_palette <span class="op">=</span> <span class="st">'viridis'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-274936f0389ad8673973" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-274936f0389ad8673973">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"2\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#21908CFF\"] \n  \"3\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"4\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#21908CFF\"] \n  \"5\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"6\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"7\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"8\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"9\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"10\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"11\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"12\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"13\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"14\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"15\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"16\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"17\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n  \"18\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"19\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"20\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n  \"21\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"8\"->\"9\" [label = \"NNN\"] \n\"2\"->\"10\" [label = \"NNT\"] \n\"4\"->\"11\" [label = \"NNT\"] \n\"6\"->\"12\" [label = \"NNT\"] \n\"8\"->\"13\" [label = \"NNT\"] \n\"2\"->\"14\" [label = \"NTT\"] \n\"4\"->\"15\" [label = \"NTT\"] \n\"6\"->\"16\" [label = \"NTT\"] \n\"8\"->\"17\" [label = \"NTT\"] \n\"2\"->\"18\" [label = \"TTT\"] \n\"4\"->\"19\" [label = \"TTT\"] \n\"6\"->\"20\" [label = \"TTT\"] \n\"8\"->\"21\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Notice how this is different to the advice we get at the start of the
trial (i.e. when omitting the <code>previous_outcomes</code>):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin.html">get_boin</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">4</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, viridis_palette <span class="op">=</span> <span class="st">'viridis'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-73013c4a916358665257" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-73013c4a916358665257">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"2\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#21908CFF\"] \n  \"3\" [label = \"3\", fontcolor = \"#440154FF\", fillcolor = \"#5DC863FF\"] \n  \"4\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"5\" [label = \"2\", fontcolor = \"#FDE725FF\", fillcolor = \"#21908CFF\"] \n  \"6\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"7\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"8\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n  \"9\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"10\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"11\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"12\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"13\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"14\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n  \"15\" [label = \"1\", fontcolor = \"#5DC863FF\", fillcolor = \"#3B528BFF\"] \n  \"16\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n  \"17\" [label = \"Stop\", fontcolor = \"#21908CFF\", fillcolor = \"#440154FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"2\"->\"9\" [label = \"NNT\"] \n\"4\"->\"10\" [label = \"NNT\"] \n\"6\"->\"11\" [label = \"NNT\"] \n\"2\"->\"12\" [label = \"NTT\"] \n\"4\"->\"13\" [label = \"NTT\"] \n\"6\"->\"14\" [label = \"NTT\"] \n\"2\"->\"15\" [label = \"TTT\"] \n\"4\"->\"16\" [label = \"TTT\"] \n\"6\"->\"17\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>This is a feature of model-based methods like CRM and BOIN - they use
all information at all doses when making dose decisions. They are not
memoryless like the 3+3.</p>
</div>
<div class="section level3">
<h3 id="next-dose">Next dose<a class="anchor" aria-label="anchor" href="#next-dose"></a>
</h3>
<p>The dose at which dose-paths commence is inferred from the model. It
can be specified manually, however:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_three_plus_three.html">get_three_plus_three</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">5</span>, allow_deescalate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, next_dose <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"RSTUDIO"</span><span class="op">)</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">paths</span>, viridis_palette <span class="op">=</span> <span class="st">'plasma'</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e3be3be66bc360a6814a" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-e3be3be66bc360a6814a">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"3\", fontcolor = \"#0D0887FF\", fillcolor = \"#E16462FF\"] \n  \"2\" [label = \"4\", fontcolor = \"#6A00A8FF\", fillcolor = \"#FCA636FF\"] \n  \"3\" [label = \"5\", fontcolor = \"#B12A90FF\", fillcolor = \"#F0F921FF\"] \n  \"4\" [label = \"3\", fontcolor = \"#0D0887FF\", fillcolor = \"#E16462FF\"] \n  \"5\" [label = \"4\", fontcolor = \"#6A00A8FF\", fillcolor = \"#FCA636FF\"] \n  \"6\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"7\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"8\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"9\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"10\" [label = \"4\", fontcolor = \"#6A00A8FF\", fillcolor = \"#FCA636FF\"] \n  \"11\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"12\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"13\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"14\" [label = \"3\", fontcolor = \"#0D0887FF\", fillcolor = \"#E16462FF\"] \n  \"15\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"16\" [label = \"1\", fontcolor = \"#FCA636FF\", fillcolor = \"#6A00A8FF\"] \n  \"17\" [label = \"1\", fontcolor = \"#FCA636FF\", fillcolor = \"#6A00A8FF\"] \n  \"18\" [label = \"3\", fontcolor = \"#0D0887FF\", fillcolor = \"#E16462FF\"] \n  \"19\" [label = \"2\", fontcolor = \"#F0F921FF\", fillcolor = \"#B12A90FF\"] \n  \"20\" [label = \"1\", fontcolor = \"#FCA636FF\", fillcolor = \"#6A00A8FF\"] \n  \"21\" [label = \"1\", fontcolor = \"#FCA636FF\", fillcolor = \"#6A00A8FF\"] \n\"1\"->\"2\" [label = \"NNN\"] \n\"2\"->\"3\" [label = \"NNN\"] \n\"1\"->\"4\" [label = \"NNT\"] \n\"4\"->\"5\" [label = \"NNN\"] \n\"1\"->\"6\" [label = \"NTT\"] \n\"6\"->\"7\" [label = \"NNN\"] \n\"1\"->\"8\" [label = \"TTT\"] \n\"8\"->\"9\" [label = \"NNN\"] \n\"2\"->\"10\" [label = \"NNT\"] \n\"4\"->\"11\" [label = \"NNT\"] \n\"6\"->\"12\" [label = \"NNT\"] \n\"8\"->\"13\" [label = \"NNT\"] \n\"2\"->\"14\" [label = \"NTT\"] \n\"4\"->\"15\" [label = \"NTT\"] \n\"6\"->\"16\" [label = \"NTT\"] \n\"8\"->\"17\" [label = \"NTT\"] \n\"2\"->\"18\" [label = \"TTT\"] \n\"4\"->\"19\" [label = \"TTT\"] \n\"6\"->\"20\" [label = \"TTT\"] \n\"8\"->\"21\" [label = \"TTT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>A 3+3 trial with de-escalation enabled will de-escalate through the
doses when toxicity is seen, as expected.</p>
</div>
</div>
<div class="section level2">
<h2 id="crystallised-dose-paths">Crystallised dose-paths<a class="anchor" aria-label="anchor" href="#crystallised-dose-paths"></a>
</h2>
<p>Calculating dose-paths is useful for visually examining the
conditions under which a dose-finding design would escalate or
de-escalate or stop. However, that is only part of the story. When we
marry dose-paths with assumed true event probabilities, we can calculate
exact operating characteristics of a design. We refer to this as
<em>crystallising</em> dose paths because the likelihood of each path
has been calculated precisely according to an assumed truth.</p>
<p>For instance, we can calculate dose-paths for the first four cohorts
of three patients using the CRM with stopping design that we specified
previously:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">skeleton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stop_when_too_toxic.html">stop_when_too_toxic</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">1</span>, tox_threshold <span class="op">=</span> <span class="fl">0.35</span>, confidence <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 341 model evaluations. Be patient.</span></span></code></pre></div>
<p>We can then crystallise the paths using toxicity probabilities that
exactly match the beliefs in our skeleton:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_prob_tox</span> <span class="op">&lt;-</span> <span class="va">skeleton</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/calculate_probabilities.html">calculate_probabilities</a></span><span class="op">(</span>true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; Number of nodes: 213 </span></span>
<span><span class="co">#&gt; Number of terminal nodes: 160 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.05 0.10 0.25 0.40 0.60 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt;   NoDose        1        2        3        4        5 </span></span>
<span><span class="co">#&gt; 0.000127 0.019866 0.227135 0.451791 0.273014 0.028066 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of continuance:</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;      1      2      3      4      5 </span></span>
<span><span class="co">#&gt; 0.3172 0.1602 0.1867 0.2734 0.0626 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected sample size:</span></span>
<span><span class="co">#&gt; 11.99887</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected total toxicities:</span></span>
<span><span class="co">#&gt; 2.705489</span></span></code></pre></div>
<p>We see that in this scenario, the probability of a path stopping and
advocating no dose within the first four cohorts is very close to zero.
In contrast, when the toxicity probabilities are much greater than
anticipated:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_prob_tox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.6</span>, <span class="fl">0.68</span>, <span class="fl">0.75</span>, <span class="fl">0.81</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/calculate_probabilities.html">calculate_probabilities</a></span><span class="op">(</span>true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; Number of nodes: 213 </span></span>
<span><span class="co">#&gt; Number of terminal nodes: 160 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.45 0.60 0.68 0.75 0.81 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt;    NoDose         1         2         3         4         5 </span></span>
<span><span class="co">#&gt; 0.3027462 0.6407708 0.0502073 0.0055527 0.0006931 0.0000299 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of continuance:</span></span>
<span><span class="co">#&gt; [1] 0.697</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5 </span></span>
<span><span class="co">#&gt; 0.895800 0.052921 0.008539 0.042028 0.000711 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected sample size:</span></span>
<span><span class="co">#&gt; 10.73269</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected total toxicities:</span></span>
<span><span class="co">#&gt; 5.102913</span></span></code></pre></div>
<p>the probability of selecting no dose within these first four cohorts
is over 30%. The information labelled
<code>Probability of continuance:</code> shows the aggregate probability
of paths that are continuing to advocate experimentation at doses,
i.e. those paths that do not advocate stopping.</p>
<p>We see above that the probability of continuance is 1 minus the
probability of selecting no dose. However, this need not necessarily be
the case because paths can advocate stopping <em>and recommend a
dose</em>. They might do so once it is felt that a suitable dose has
been identified. To make this point, let us imagine that we add a rule
to our above design that allows stopping once there are 9 patients
allocated to the recommended dose. We can think of this as stopping for
consensus. Respecifying our model and recalculating dose-paths, we
have:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stop_when_too_toxic.html">stop_when_too_toxic</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">1</span>, tox_threshold <span class="op">=</span> <span class="fl">0.35</span>, confidence <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_when_n_at_dose.html">stop_when_n_at_dose</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="st">'recommended'</span>, n <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 341 model evaluations. Be patient.</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/calculate_probabilities.html">calculate_probabilities</a></span><span class="op">(</span>true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; Number of nodes: 141 </span></span>
<span><span class="co">#&gt; Number of terminal nodes: 106 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.45 0.60 0.68 0.75 0.81 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt;    NoDose         1         2         3         4         5 </span></span>
<span><span class="co">#&gt; 0.2103223 0.7393498 0.0440522 0.0055527 0.0006931 0.0000299 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of continuance:</span></span>
<span><span class="co">#&gt; [1] 0.137</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5 </span></span>
<span><span class="co">#&gt; 0.895800 0.052921 0.008539 0.042028 0.000711 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected sample size:</span></span>
<span><span class="co">#&gt; 9.064864</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected total toxicities:</span></span>
<span><span class="co">#&gt; 4.352391</span></span></code></pre></div>
<p>We see that this has reduced our probability of stopping for excess
toxicity and inflated our chances of recommending dose 1. Notably, the
probability of continuance is now roughly 14%, suggesting that most
paths have advocated stopping by now, either for toxicity or
concensus.</p>
<p>If we do not like that performance, we can make the consensus
stopping rule more demanding by requesting 12 at the recommended dose to
advocate stopping:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stop_when_too_toxic.html">stop_when_too_toxic</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="fl">1</span>, tox_threshold <span class="op">=</span> <span class="fl">0.35</span>, confidence <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_when_n_at_dose.html">stop_when_n_at_dose</a></span><span class="op">(</span>dose <span class="op">=</span> <span class="st">'recommended'</span>, n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span>cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 341 model evaluations. Be patient.</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">paths</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/calculate_probabilities.html">calculate_probabilities</a></span><span class="op">(</span>true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; Number of nodes: 213 </span></span>
<span><span class="co">#&gt; Number of terminal nodes: 160 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.45 0.60 0.68 0.75 0.81 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt;    NoDose         1         2         3         4         5 </span></span>
<span><span class="co">#&gt; 0.3027462 0.6407708 0.0502073 0.0055527 0.0006931 0.0000299 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of continuance:</span></span>
<span><span class="co">#&gt; [1] 0.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;        1        2        3        4        5 </span></span>
<span><span class="co">#&gt; 0.895800 0.052921 0.008539 0.042028 0.000711 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected sample size:</span></span>
<span><span class="co">#&gt; 10.73269</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected total toxicities:</span></span>
<span><span class="co">#&gt; 5.102913</span></span></code></pre></div>
<p>As usual, deriving an acceptable design is an iterative process. The
tools in <code>escalation</code> make it easier to arrive at a design
that performs how you want.</p>
<p>Combining dose-paths with true event probabilities allows
probabilistic inference on dose-finding designs. This is a novel
extension to the use advocated by <span class="citation">Yap et al.
(2017)</span> and <span class="citation">Brock et al. (2017)</span>. The
use of exact operating characteristics has been implemented for the 3+3
design in the <code>bcrm</code> package <span class="citation">(Sweeting
and Wheeler 2019)</span>. We generalise the method here.</p>
<div class="section level3">
<h3 id="dose-paths-vs-simulation">Dose-paths vs simulation<a class="anchor" aria-label="anchor" href="#dose-paths-vs-simulation"></a>
</h3>
<p>We saw above that probabilistic inference was possible with
dose-paths. Researchers have typically used simulation to achieve this
task. <code>escalation</code> supports simulation as well through the
<code>simulate_trials</code> function. However, this does raise the
question, when should you use each method, and what are their relative
merits?</p>
<p>The answer to the first question comes down to the expected number of
model fits required. Fitting dose-finding models takes computer time. In
dose-paths, the model is fit once at each node. We have seen examples
above of how the number and size of cohorts affects the number of nodes
in dose-paths. In fact, <code>escalation</code> provides a function to
calculate the number of nodes.</p>
<p>In a phase 1 dose-finding trial, each patient experiences exactly one
of two outcomes: <code>T</code> or <code>N</code>. Let us calculate how
many nodes there are in a graph of dose-paths using five cohorts of
three patients. We run:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_dose_path_nodes.html">num_dose_path_nodes</a></span><span class="op">(</span>num_patient_outcomes <span class="op">=</span> <span class="fl">2</span>, cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]    1    4   16   64  256 1024</span></span></code></pre></div>
<p>The <code>num_patient_outcomes = 2</code> parameter reflects that
patients may experience <code>T</code> or <code>N</code>. The returned
vector of integers is the number of nodes at each depth. There is one
starting node. That node is connected to four children via outcomes
<code>NNN</code>, <code>NNT</code>, <code>NTT</code>, and
<code>TTT</code>. The number of nodes at greater depths proceeds
multiplicatively thereafter. The total number of nodes is:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_dose_path_nodes.html">num_dose_path_nodes</a></span><span class="op">(</span>num_patient_outcomes <span class="op">=</span> <span class="fl">2</span>, cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">sum</span></span>
<span><span class="co">#&gt; [1] 1365</span></span></code></pre></div>
<p>Thus it requires exactly 1,365 model fits to calculate the exact
operating characteristics in this <span class="math inline">\(n = 5
\times 3 = 15\)</span> patient scenario. To compare this to simulations,
consider that each simulated trial iteration will fit the model up to
five times, once at the end of each cohort. The total number of model
fits in a simulation study is bounded by this number multiplied by the
number of simulated iterations. Generally simulation studies use
thousands of replicates, so it is easy to see that exact inference via
crystallised dose-paths will be much less computaionally burdensome, and
therefore faster here.</p>
<p>In contrast, now consider a trial of eight cohorts of three. The
total number of model fits to enumerate the complete graph of dose-paths
is</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num_dose_path_nodes.html">num_dose_path_nodes</a></span><span class="op">(</span>num_patient_outcomes <span class="op">=</span> <span class="fl">2</span>, cohort_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">sum</span></span>
<span><span class="co">#&gt; [1] 87381</span></span></code></pre></div>
<p>Ten thousand simulated iterations of 8 cohorts each would only
require up to 80,000 model fits. Thus, a reasonably accurate simulation
study would be expected to be faster here.</p>
<p>However, speed is not the only concern: there is also precision to
consider. Simulations have the disadvantage of suffering from Monte
Carlo error, that is the uncertainty about the estimated statistics
arising from the use of a finite number of simulated iterations. In
contrast, exact inference via dose-paths has the great advantage of
being exact. That is, there is no uncertainty in the calculated
probabilities. (Note: there is still uncertainty about which path will
be taken because that is determined by random patient outcomes). Thus,
there are scenarios when dose-paths may still be preferable to
simulations, even when they are expected to take longer.</p>
<p>It is likely that in practice, simulation is used when dose-paths
would be a better option. If true, that would likely be linked to
provision of software that performs the two methods.
<code>escalation</code> plugs that gap.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Brock2017a" class="csl-entry">
Brock, Kristian, Lucinda Billingham, Mhairi Copland, Shamyla Siddique,
Mirjana Sirovica, and Christina Yap. 2017. <span>“Implementing the
<span>EffTox</span> Dose-Finding Design in the <span>Matchpoint</span>
Trial.”</span> <em>BMC Medical Research Methodology</em> 17 (1): 112. <a href="https://doi.org/10.1186/s12874-017-0381-x" class="external-link">https://doi.org/10.1186/s12874-017-0381-x</a>.
</div>
<div id="ref-dfcrm" class="csl-entry">
Cheung, Ken. 2013. <em>Dfcrm: Dose-Finding by the Continual Reassessment
Method</em>. <a href="https://CRAN.R-project.org/package=dfcrm" class="external-link">https://CRAN.R-project.org/package=dfcrm</a>.
</div>
<div id="ref-liu_bayesian_2015" class="csl-entry">
Liu, Suyu, and Ying Yuan. 2015. <span>“Bayesian Optimal Interval Designs
for Phase <span>I</span> Clinical Trials.”</span> <em>Journal of the
Royal Statistical Society: Series C (Applied Statistics)</em> 64 (3):
507–23. <a href="https://doi.org/10.1111/rssc.12089" class="external-link">https://doi.org/10.1111/rssc.12089</a>.
</div>
<div id="ref-OQuigley1990" class="csl-entry">
O’Quigley, J, M Pepe, and L Fisher. 1990. <span>“Continual Reassessment
Method: A Practical Design for Phase 1 Clinical Trials in
Cancer.”</span> <em>Biometrics</em> 46 (1): 33–48. <a href="https://doi.org/10.2307/2531628" class="external-link">https://doi.org/10.2307/2531628</a>.
</div>
<div id="ref-bcrm" class="csl-entry">
Sweeting, Michael, and Graham Wheeler. 2019. <em>Bcrm: Bayesian
Continual Reassessment Method for Phase i Dose-Escalation Trials</em>.
<a href="https://CRAN.R-project.org/package=bcrm" class="external-link">https://CRAN.R-project.org/package=bcrm</a>.
</div>
<div id="ref-wheelerHowDesignDosefinding2019" class="csl-entry">
Wheeler, Graham M., Adrian P. Mander, Alun Bedding, Kristian Brock,
Victoria Cornelius, Andrew P. Grieve, Thomas Jaki, et al. 2019.
<span>“How to Design a Dose-Finding Study Using the Continual
Reassessment Method.”</span> <em>BMC Medical Research Methodology</em>
19 (1). <a href="https://doi.org/10.1186/s12874-018-0638-z" class="external-link">https://doi.org/10.1186/s12874-018-0638-z</a>.
</div>
<div id="ref-Yap2017" class="csl-entry">
Yap, Christina, Lucinda J. Billingham, Ying Kuen Cheung, Charlie
Craddock, and John O’Quigley. 2017. <span>“Dose Transition Pathways:
<span>The</span> Missing Link Between Complex Dose-Finding Designs and
Simple Decision-Making.”</span> <em>Clinical Cancer Research</em> 23
(24): 7440–47. <a href="https://doi.org/10.1158/1078-0432.CCR-17-0582" class="external-link">https://doi.org/10.1158/1078-0432.CCR-17-0582</a>.
</div>
<div id="ref-BOIN" class="csl-entry">
Yuan, Ying, and Suyu Liu. 2018. <em>BOIN: Bayesian Optimal INterval
(BOIN) Design for Single-Agent and Drug- Combination Phase i Clinical
Trials</em>. <a href="https://CRAN.R-project.org/package=BOIN" class="external-link">https://CRAN.R-project.org/package=BOIN</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
