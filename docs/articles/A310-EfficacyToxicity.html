<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs • escalation</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">escalation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A100-DoseSelectors.html">Using escalation</a>
    </li>
    <li>
      <a href="../articles/A205-CRM.html">CRM - Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/A207-NBG.html">NBG - Neuenschwander, Branson &amp; Gsponer</a>
    </li>
    <li>
      <a href="../articles/A210-TPI.html">TPI - Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A220-mTPI.html">mTPI - Modified Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A230-BOIN.html">BOIN - Bayesian Optimal Interval Design</a>
    </li>
    <li>
      <a href="../articles/A280-TITE.html">TITE-CRM and TITE-NBG - Time-to-Event Designs</a>
    </li>
    <li>
      <a href="../articles/A310-EfficacyToxicity.html">EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs</a>
    </li>
    <li>
      <a href="../articles/A360-Combinations.html">BOIN-COMB - Treatment Combination Designs</a>
    </li>
    <li>
      <a href="../articles/A600-DosePaths.html">Working with dose-paths</a>
    </li>
    <li>
      <a href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a>
    </li>
    <li>
      <a href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brockk/escalation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="A310-EfficacyToxicity_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="A310-EfficacyToxicity_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="A310-EfficacyToxicity_files/viz-1.8.2/viz.js"></script><link href="A310-EfficacyToxicity_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="A310-EfficacyToxicity_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>EffTox, Wages &amp; Tait, and BOIN12 - Efficacy
&amp; Toxicity Designs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/HEAD/vignettes/A310-EfficacyToxicity.Rmd" class="external-link"><code>vignettes/A310-EfficacyToxicity.Rmd</code></a></small>
      <div class="hidden name"><code>A310-EfficacyToxicity.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Seamless phase I/II designs extend the typical phase I or <em>maximum
tolerated dose</em>-seeking approach by incorporating efficacy outcomes
into the dose selection decision. Researchers will be motivated to
escalate dose whilst there is a lack of efficacy and de-escalate under
the presence of excess toxicity.</p>
<p>One of the earliest designs in this space was EffTox by <span class="citation">P. F. Thall and Cook (2004)</span>. Their design uses
logit models for the probability of toxicity and efficacy at the
research doses, and allows the two events to be correlated in a joint
model. <span class="citation">Wages and Tait (2015)</span> introduced a
multi-stage design that uses response-adaptive randomisation to explore
the doses. Most recently, <span class="citation">Lin et al.
(2020)</span> introduced a generalisation of the BOIN Bayesian interval
design for efficacy and toxicity outcomes called BOIN12. These designs
are implemented in <code>escalation</code> and demonstrated below.</p>
<p>First, we must learn how to specify efficacy and toxicity outcomes in
<code>escalation</code>. We do that in the next section.</p>
</div>
<div class="section level2">
<h2 id="outcome-nomenclature">Outcome nomenclature<a class="anchor" aria-label="anchor" href="#outcome-nomenclature"></a>
</h2>
<p>In a joint phase I/II trial, where we have coincident efficacy and
toxicity outcomes, we present outcomes in the individual patients using
the letters:</p>
<ul>
<li>
<code>T</code> to show that toxicity without efficacy occurred in a
patient;</li>
<li>
<code>E</code> to show that efficacy without toxicity occurred in a
patient;</li>
<li>
<code>N</code> to show that neither occurred;</li>
<li>
<code>B</code> to show that both occurred.</li>
</ul>
<p>These outcome letters are strewn behind dose-levels to show the
outcomes of patients in cohorts. To show that a cohort a three patients
was given dose 2, with the first experiencing toxicity without efficacy,
the second experiencing efficacy without toxicity, and the third
experiencing both, we would use the outcome string:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'2TEB'</span></span></code></pre></div>
<p>There are many more examples below.</p>
</div>
<div class="section level2">
<h2 id="efftox">EffTox<a class="anchor" aria-label="anchor" href="#efftox"></a>
</h2>
<p>Thall &amp; Cook <span class="citation">(P. F. Thall and Cook
2004)</span> introduced the <em>EffTox</em> design for dose-finding
clinical trials where both efficacy and toxicity events guide dose
selection decisions. We provide a brief recap of EffTox here, but full
details are given in <span class="citation">(P. F. Thall and Cook 2004;
P. Thall, Cook, and Estey 2006; P. Thall et al. 2014)</span>.</p>
<p>For doses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐲</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{y} = (y_1, ..., y_n)</annotation></semantics></math>,
the authors define codified doses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_1, ..., x_n)</annotation></semantics></math>
using the transform</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mo>log</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mfrac><mrow><mo>log</mo><msub><mi>y</mi><mi>j</mi></msub></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">x_i = \log{y_i} - \sum_{j=1}^n \frac{\log{y_j}}{n}</annotation></semantics></math></p>
<p>The codified doses are used as the explanatory variables in logit
models for the marginal probabilities of toxicity and efficacy:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="normal">logit </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>π</mi><mi>T</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\text{logit } \pi_T = \alpha + \beta x</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mtext mathvariant="normal">logit </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>π</mi><mi>E</mi></msub><mo>=</mo><mi>γ</mi><mo>+</mo><mi>ζ</mi><mi>x</mi><mo>+</mo><mi>η</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\text{logit } \pi_E = \gamma + \zeta x + \eta x^2</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>j</mi></msub><mo>,</mo><msub><mi>Z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Y_j, Z_j)</annotation></semantics></math>
be random variables each taking values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0, 1\}</annotation></semantics></math>
representing the presence of efficacy and toxicity in patient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</p>
<p>Then the efficacy and toxicity events are associated by the joint
probability function</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>Z</mi><mo>=</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>π</mi><mrow><mi>a</mi><mo>,</mo><mi>b</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>E</mi></msub><mo>,</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>a</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><mi>a</mi></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>b</mi></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><mi>b</mi></mrow></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><msup><mi>e</mi><mi>ψ</mi></msup><mo>−</mo><mn>1</mn></mrow><mrow><msup><mi>e</mi><mi>ψ</mi></msup><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">Pr(Y = a, Z = b) = \pi_{a,b}(\pi_E, \pi_T) = (\pi_E)^a (1-\pi_E)^{1-a} (\pi_T)^b (1-\pi_T)^{1-b} + (-1)^{a+b} (\pi_E) (1-\pi_E) (\pi_T) (1-\pi_T) \frac{e^\psi-1}{e^\psi+1}</annotation></semantics></math>.</p>
<p>Normal priors are specified for the elements of the parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝛉</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>ζ</mi><mo>,</mo><mi>η</mi><mo>,</mo><mi>ψ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta} = (\alpha, \beta, \gamma, \zeta, \eta, \psi)</annotation></semantics></math>.</p>
<p>At each dose update decision, the dose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is acceptable if</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>π</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msub><mover><mi>π</mi><mo accent="true">¯</mo></mover><mi>T</mi></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">}</mo></mrow><mo>&gt;</mo><msub><mi>p</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\text{Pr}\left\{ \pi_T(x, \boldsymbol{\theta}) &lt; \overline{\pi}_T | \text{data} \right\} &gt; p_T</annotation></semantics></math></p>
<p>and</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Pr</mtext><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>π</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><msub><munder><mi>π</mi><mo accent="true">_</mo></munder><mi>E</mi></msub><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">}</mo></mrow><mo>&gt;</mo><msub><mi>p</mi><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">\text{Pr}\left\{ \pi_E(x, \boldsymbol{\theta}) &gt; \underline{\pi}_E | \text{data} \right\} &gt; p_E</annotation></semantics></math></p>
<p>and is no more than than one position below the lowest dose-level
given and no more than one position above the highest dose-level given.
The net effect of these last two criteria is that untried doses may not
be skipped in escalation or de-escalation.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><munder><mi>π</mi><mo accent="true">_</mo></munder><mi>E</mi></msub><mo>,</mo><msub><mi>p</mi><mi>E</mi></msub><mo>,</mo><msub><mover><mi>π</mi><mo accent="true">¯</mo></mover><mi>T</mi></msub><mo>,</mo><msub><mi>p</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\underline{\pi}_E, p_E, \overline{\pi}_T, p_T</annotation></semantics></math>
are provided by the user as the trial scenario dictates.</p>
<p>The utility of dose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
with efficacy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_E(x, \boldsymbol{\theta})</annotation></semantics></math>
and toxicity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_T(x, \boldsymbol{\theta})</annotation></semantics></math>
is</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>π</mi><mi>E</mi></msub><mo>,</mo><msub><mi>π</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>E</mi></msub></mrow><mrow><mn>1</mn><mo>−</mo><msubsup><mi>π</mi><mrow><mn>1</mn><mo>,</mo><mi>E</mi></mrow><mo>*</mo></msubsup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi></msup><mo>+</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>π</mi><mi>T</mi></msub><msubsup><mi>π</mi><mrow><mn>2</mn><mo>,</mo><mi>T</mi></mrow><mo>*</mo></msubsup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow><annotation encoding="application/x-tex">u(\pi_E, \pi_T) = 1 - \left( \left(\frac{1-\pi_E}{1-\pi_{1,E}^*}\right)^p + \left(\frac{\pi_T}{\pi_{2,T}^*}\right)^p \right) ^ \frac{1}{p}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is calculated to intersect the points
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>π</mi><mrow><mn>1</mn><mo>,</mo><mi>E</mi></mrow><mo>*</mo></msubsup><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\pi_{1,E}^*, 0)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><msubsup><mi>π</mi><mrow><mn>2</mn><mo>,</mo><mi>T</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1, \pi_{2,T}^*)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>π</mi><mrow><mn>3</mn><mo>,</mo><mi>E</mi></mrow><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>π</mi><mrow><mn>3</mn><mo>,</mo><mi>T</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\pi_{3,E}^*, \pi_{3,T}^*)</annotation></semantics></math>
in the efficacy-toxicity plain. We refer to these as <em>hinge
points</em> but that is not common nomenclature.</p>
<p>At the dose selection decision, the dose-level from the acceptable
set with maximal utility is selected to be given to the next patient or
cohort. If there are no acceptable doses, the trial stops and no dose is
recommended.</p>
<p>There are several published EffTox examples, including explanations
and tips on parameter choices <span class="citation">(P. F. Thall and
Cook 2004; P. Thall, Cook, and Estey 2006; P. Thall et al.
2014)</span>.</p>
</div>
<div class="section level2">
<h2 id="wages-tait">Wages &amp; Tait<a class="anchor" aria-label="anchor" href="#wages-tait"></a>
</h2>
<p>The design of <span class="citation">Wages and Tait (2015)</span>
uses latent CRM models to estimate the probabilities of toxicity and
efficacy, and two stages to identify the recommended dose. In the first
stage, the design sequentially seeks the dose with probability of
toxicity nearest to an upper toxicity threshold, like the classic CRM
approach. In the second stage, the design adaptively randomises to the
permissible doses, i.e. those with probability of toxicity not
considered statistically too toxic, with greater randomisation weight
given to those doses with higher estimated efficacy rates. The design
uses a toxicity skeleton, like CRM, and several competing efficacy
skeletons to accommodate that efficacy may not be monotonically
increasing in dose.</p>
</div>
<div class="section level2">
<h2 id="boin12">BOIN12<a class="anchor" aria-label="anchor" href="#boin12"></a>
</h2>
<p>The Bayesian Optimal Interval (BOIN) design was introduced by <span class="citation">Liu and Yuan (2015)</span>. It is one of a series of
dose-finding trial designs that works by partitioning the probability of
toxicity into a set of intervals. These designs make dose-selection
decisions that are determined by the interval in which the probability
of toxicity for the current dose is believed to reside. The BOIN12
generalisation applies similar logic to co-primary binary toxicity and
efficacy outcomes.</p>
</div>
<div class="section level2">
<h2 id="implementation-in-escalation">Implementation in <code>escalation</code><a class="anchor" aria-label="anchor" href="#implementation-in-escalation"></a>
</h2>
<p>To demonstrate the methods, let us consider the recommended dose
after observing outcomes <code>1NNN 2EBT</code> seeking a dose no more
toxic than 0.3 with an associated efficacy probability of at least
0.5.</p>
<p>In each design, there will be many parameters that need to be set
because these designs are comparatively complex. Ordinarily, parameter
choices would be justified in light of the prevailing clinical scenario,
and evaluated by simulation. For the purposes of illustration in this
document, however, we are going to proceed with typical or general
values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://brockk.github.io/escalation/" class="external-link">escalation</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">"1NNN 2EBT"</span></span></code></pre></div>
<div class="section level3">
<h3 id="efftox-1">EffTox<a class="anchor" aria-label="anchor" href="#efftox-1"></a>
</h3>
<p>For simplicity, we will use the parametersiation specified in an
example investigating five doses in <span class="citation">P. Thall et
al. (2014)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">trialr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/trialr/man/efftox_priors.html" class="external-link">efftox_priors</a></span><span class="op">(</span></span>
<span>  alpha_mean <span class="op">=</span> <span class="op">-</span><span class="fl">7.9593</span>, alpha_sd <span class="op">=</span> <span class="fl">3.5487</span>,</span>
<span>  beta_mean <span class="op">=</span> <span class="fl">1.5482</span>, beta_sd <span class="op">=</span> <span class="fl">3.5018</span>,</span>
<span>  gamma_mean <span class="op">=</span> <span class="fl">0.7367</span>, gamma_sd <span class="op">=</span> <span class="fl">2.5423</span>,</span>
<span>  zeta_mean <span class="op">=</span> <span class="fl">3.4181</span>, zeta_sd <span class="op">=</span> <span class="fl">2.4406</span>,</span>
<span>  eta_mean <span class="op">=</span> <span class="fl">0</span>, eta_sd <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  psi_mean <span class="op">=</span> <span class="fl">0</span>, psi_sd <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">real_doses</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">4.0</span>, <span class="fl">6.6</span>, <span class="fl">10.0</span><span class="op">)</span></span>
<span><span class="va">num_doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">real_doses</span><span class="op">)</span></span>
<span></span>
<span><span class="va">et_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trialr_efftox.html">get_trialr_efftox</a></span><span class="op">(</span></span>
<span>  real_doses <span class="op">=</span> <span class="va">real_doses</span>,</span>
<span>  efficacy_hurdle <span class="op">=</span> <span class="fl">0.5</span>, toxicity_hurdle <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fl">0.1</span>, p_t <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  eff0 <span class="op">=</span> <span class="fl">0.5</span>, tox1 <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  eff_star <span class="op">=</span> <span class="fl">0.7</span>, tox_star <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  priors <span class="op">=</span> <span class="va">p</span>, </span>
<span>  <span class="co"># Low MCMC sample size purely for speed in vignette:</span></span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">2020</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">et_fit</span> <span class="op">&lt;-</span> <span class="va">et_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">et_fit</span></span>
<span><span class="co">#&gt; Patient-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   Patient Cohort  Dose   Tox   Eff</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1      1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2      1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3      1     1     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4      2     2     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5      2     2     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6      2     2     1     0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dose-level data:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 12</span></span></span>
<span><span class="co">#&gt;   dose     tox   eff     n empiric_tox_rate mean_prob_tox median_prob_tox</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NoDose     0     0     0            0             0               0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1          0     0     3            0             0.171           0.123</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2          2     2     3            0.667         0.298           0.273</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 3          0     0     0          <span style="color: #BB0000;">NaN</span>             0.503           0.516</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 4          0     0     0          <span style="color: #BB0000;">NaN</span>             0.583           0.699</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5          0     0     0          <span style="color: #BB0000;">NaN</span>             0.620           0.811</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: empiric_eff_rate &lt;dbl&gt;, mean_prob_eff &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   median_prob_eff &lt;dbl&gt;, admissible &lt;lgl&gt;, recommended &lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model uses a toxicity limit of 0.3.</span></span>
<span><span class="co">#&gt; The model uses an efficacy limit of 0.5.</span></span>
<span><span class="co">#&gt; The model advocates continuing at dose 3.</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">et_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">et_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dose_admissible.html">dose_admissible</a></span><span class="op">(</span><span class="va">et_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE  TRUE  TRUE FALSE FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wages-tait-1">Wages &amp; Tait<a class="anchor" aria-label="anchor" href="#wages-tait-1"></a>
</h3>
<p>For simplicity we will use the parametersiation specified in <span class="citation">Wages and Tait (2015)</span>, tweaked slightly to
reflect the dose-levels and targets specified in the EffTox example
above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tox_skeleton</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.15</span>, <span class="fl">0.22</span>, <span class="fl">0.29</span>, <span class="fl">0.36</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eff_skeletons</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">9</span>, ncol <span class="op">=</span> <span class="va">num_doses</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.40</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.40</span>, <span class="fl">0.30</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span>, <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">4</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.50</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">5</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">6</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">7</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.40</span>, <span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">8</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span><span class="op">)</span></span>
<span><span class="va">eff_skeletons</span><span class="op">[</span><span class="fl">9</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span>, <span class="fl">0.60</span><span class="op">)</span></span>
<span><span class="va">eff_skeleton_weights</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">eff_skeletons</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wt_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_wages_and_tait.html">get_wages_and_tait</a></span><span class="op">(</span></span>
<span>  tox_skeleton <span class="op">=</span> <span class="va">tox_skeleton</span>,</span>
<span>  eff_skeletons <span class="op">=</span> <span class="va">eff_skeletons</span>,</span>
<span>  tox_limit <span class="op">=</span> <span class="fl">0.3</span>, eff_limit <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  num_randomise <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The toxicity skeleton specified above plays exactly the equivalent
role as seen in the CRM design. There are several efficacy skeletons to
allow that efficacy may not be monotonic in dose. We use efficacy
skeletons to reflect that: i) each dose may be the maximum, with
monotonic increase and subsequent decrease relative to that dose; and
ii) that each dose may be a plateau point, with equal efficacy at higher
doses. In general, this generates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2n - 1</annotation></semantics></math>
efficacy skeletons in a trial of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
doses. The probabilities in the efficacy skeletons are less important
than the shape the skeleton conveys because the average height of the
dose-efficacy curve will be adjusted in Bayesian updating.</p>
<p>We fit the model to the outcomes:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt_fit</span> <span class="op">&lt;-</span> <span class="va">wt_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<p>and see that a dose is advised for the next cohort:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">wt_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">wt_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Note that this design differs from EffTox in which doses it infers to
be admissible. Different designs behave in different ways!</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dose_admissible.html">dose_admissible</a></span><span class="op">(</span><span class="va">wt_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
<p>Uncommonly seen in dose-finding designs, this design is a randomising
design:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_randomising.html">is_randomising</a></span><span class="op">(</span><span class="va">wt_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Doses are assigned to patients in the first trial stage in a
non-randomising way (i.e. the same outcomes fit to the same design will
yield the same recommended dose). In contrast, doses are randomised in
the second trial stage correlated to the modelled efficacy probability
at each dose.</p>
</div>
<div class="section level3">
<h3 id="boin12-1">BOIN12<a class="anchor" aria-label="anchor" href="#boin12-1"></a>
</h3>
<p>For illustration, we use the parameterisation presented and justified
in <span class="citation">Liu and Yuan (2015)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin12.html">get_boin12</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="fl">5</span>, phi_t <span class="op">=</span> <span class="fl">0.3</span>, phi_e <span class="op">=</span> <span class="fl">0.5</span>, u2 <span class="op">=</span> <span class="fl">40</span>, u3 <span class="op">=</span> <span class="fl">60</span>, n_star <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We fit the model to outcomes using the usual method:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_fit</span> <span class="op">&lt;-</span> <span class="va">b_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span></span></code></pre></div>
<p>And we can obtain the usual information as presented in many places
in these vignettes:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="va">b_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/continue.html">continue</a></span><span class="op">(</span><span class="va">b_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dose_admissible.html">dose_admissible</a></span><span class="op">(</span><span class="va">b_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE  TRUE  TRUE FALSE FALSE</span></span></code></pre></div>
<p>Unlike EffTox and Wages &amp; Tait, the BOIN12 design performs an
additional step at the final dose recommendation to select the dose that
is finally recommended. This same approach is used in BOIN and mTIP2,
for instance. Read on.</p>
<div class="section level4">
<h4 id="final-dose-selection">Final dose selection<a class="anchor" aria-label="anchor" href="#final-dose-selection"></a>
</h4>
<p>BOIN12, like some other designs, selects the final dose differently
to how it selects doses mid-trial. To achieve this in
<code>escalation</code>, we need an extra selector that will kick-in
when the parent selector(s) have selected a non-NA dose but expressed
<code>continue == FALSE</code>, i.e. signaled <em>the trial ends now but
we are interested in a dose</em>. If used, it will almost surely come
last in the selector chain:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin12.html">get_boin12</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="fl">5</span>, phi_t <span class="op">=</span> <span class="fl">0.3</span>, phi_e <span class="op">=</span> <span class="fl">0.5</span>, u2 <span class="op">=</span> <span class="fl">40</span>, u3 <span class="op">=</span> <span class="fl">60</span>, n_star <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/select_boin12_obd.html">select_boin12_obd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1NNN 2NTN 2NNN 3BEN'</span></span>
<span><span class="va">b_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>Note we have forced the maximum sample size to 12 and provided
outcomes for 12 patients so that the logic of
<code>select_boin12_obd</code> is invoked.</p>
<p>In the above example, <code>stop_at_n</code> stopped the trial
because the threshold sample size was met, and the underlying algorithm
identified that at least one dose was worthy of selection. At this
juncture, <code>select_boin12_obd</code> took over and applied the
method described by the authors. Whilst the underlying selector(s) were
busy conducting the trial (<code>continue == TRUE</code>),
<code>select_boin12_obd</code> kept silent.</p>
</div>
<div class="section level4">
<h4 id="rds-tabulation">RDS tabulation<a class="anchor" aria-label="anchor" href="#rds-tabulation"></a>
</h4>
<p>For convenience, we have also implemented BOIN12’s RDS (rank-based
desirability score) algorithm:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/boin12_rds.html">boin12_rds</a></span><span class="op">(</span></span>
<span> sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span> phi_t <span class="op">=</span> <span class="fl">0.35</span>,</span>
<span> phi_e <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span> u1 <span class="op">=</span> <span class="fl">100</span>,</span>
<span> u2 <span class="op">=</span> <span class="fl">40</span>,</span>
<span> u3 <span class="op">=</span> <span class="fl">60</span>,</span>
<span> u4 <span class="op">=</span> <span class="fl">0</span>,</span>
<span> c_t <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span> c_e <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span> prior_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span> prior_beta <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 166 × 6</span></span></span>
<span><span class="co">#&gt;    Patients Toxicity Efficacy Admissible RDS   RDS_x</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>        0        0        0 Admissible 60       60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>        3        0        0 Admissible 35       35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>        3        0        1 Admissible 55       55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>        3        0        2 Admissible 76       76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>        3        0        3 Admissible 91       91</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>        3        1        0 Admissible 24       24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>        3        1        1 Admissible 44       44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        3        1        2 Admissible 63       63</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>        3        1        3 Admissible 80       80</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        3        2        0 Admissible 13       13</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 156 more rows</span></span></span></code></pre></div>
<p>The return data-frame comprises:</p>
<ul>
<li>
<code>Patients</code>, the number of patients</li>
<li>
<code>Toxicity</code>, the number of patients experiencing toxicity
events</li>
<li>
<code>Efficacy</code>, the number of patients experiencing efficacy
events</li>
<li>
<code>Admissible</code>, a character label denoting admissibility
status</li>
<li>
<code>RDS</code>, a character label denoting the score in text
format</li>
<li>
<code>RDS_x</code>, the RDS in numerical form (i.e. appropriate for
sorting)</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="dose-paths">Dose paths<a class="anchor" aria-label="anchor" href="#dose-paths"></a>
</h2>
<p>As with all designs in <code>escalation</code>, we can use dose-paths
to exhaustively calculate model advice for all possible future cohorts.
However, first, a note of warning.</p>
<p>In phase 1/2 trials, there are four outcomes each patient may
experience (listed above), so there are 10 distinct combinations of
outcomes that a cohort of two patients may yield (n.b. we are counting
combinations rather than permutations), and 20 combinations that a
cohort of three may yield. This means that the size of a dose-path tree
grows very quickly, so we must be modest in our aspirations here lest we
be overwhelmed with information!</p>
<p>For example, after observing <code>1NN</code> in an initial cohort of
two patients, we will reproduce the dose-advice for the next two cohorts
of two patients (i.e. 100 paths). For comparison, we will specify that
the next dose will be 2. This starts the designs from a common place.
Naturally, this option can be omitted and the design would start from
whatever dose it recommended after seeing outcomes <code>1NN</code>.</p>
<p>To visualise paths for the EffTox design, we run:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">"1NN"</span></span>
<span></span>
<span><span class="va">et_paths</span> <span class="op">&lt;-</span> <span class="va">et_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span></span>
<span>    cohort_sizes <span class="op">=</span> <span class="va">cohort_sizes</span>, </span>
<span>    previous_outcomes <span class="op">=</span> <span class="va">outcomes</span>,</span>
<span>    next_dose <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 100 paths. Be patient.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">et_paths</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"2\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"3\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"4\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"5\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"6\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"7\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"8\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"9\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"10\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"11\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"12\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"13\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"14\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"15\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"16\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"17\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"18\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"19\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"20\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"21\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"22\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"23\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"24\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"25\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"26\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"27\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"28\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"29\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"30\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"31\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"32\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"33\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"34\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"35\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"36\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"37\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"38\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"39\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"40\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"41\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"42\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"43\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"44\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"45\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"46\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"47\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"48\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"49\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"50\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"51\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"52\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"53\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"54\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"55\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"56\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"57\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"58\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"59\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"60\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"61\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"62\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"63\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"64\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"65\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"66\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"67\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"68\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"69\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"70\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"71\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"72\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"73\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"74\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"75\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"76\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"77\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"78\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"79\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"80\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"81\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"82\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"83\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"84\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"85\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"86\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"87\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"88\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"89\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"90\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"91\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"92\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"93\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"94\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"95\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"96\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"97\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"98\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"99\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"100\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"101\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"102\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"103\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"104\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"105\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"106\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"107\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"108\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"109\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"110\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"111\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n\"1\"->\"2\" [label = \"BB\"] \n\"2\"->\"3\" [label = \"BB\"] \n\"1\"->\"4\" [label = \"BE\"] \n\"4\"->\"5\" [label = \"BB\"] \n\"1\"->\"6\" [label = \"BN\"] \n\"6\"->\"7\" [label = \"BB\"] \n\"1\"->\"8\" [label = \"BT\"] \n\"8\"->\"9\" [label = \"BB\"] \n\"1\"->\"10\" [label = \"EE\"] \n\"10\"->\"11\" [label = \"BB\"] \n\"1\"->\"12\" [label = \"EN\"] \n\"12\"->\"13\" [label = \"BB\"] \n\"1\"->\"14\" [label = \"ET\"] \n\"14\"->\"15\" [label = \"BB\"] \n\"1\"->\"16\" [label = \"NN\"] \n\"16\"->\"17\" [label = \"BB\"] \n\"1\"->\"18\" [label = \"NT\"] \n\"18\"->\"19\" [label = \"BB\"] \n\"1\"->\"20\" [label = \"TT\"] \n\"20\"->\"21\" [label = \"BB\"] \n\"2\"->\"22\" [label = \"BE\"] \n\"4\"->\"23\" [label = \"BE\"] \n\"6\"->\"24\" [label = \"BE\"] \n\"8\"->\"25\" [label = \"BE\"] \n\"10\"->\"26\" [label = \"BE\"] \n\"12\"->\"27\" [label = \"BE\"] \n\"14\"->\"28\" [label = \"BE\"] \n\"16\"->\"29\" [label = \"BE\"] \n\"18\"->\"30\" [label = \"BE\"] \n\"20\"->\"31\" [label = \"BE\"] \n\"2\"->\"32\" [label = \"BN\"] \n\"4\"->\"33\" [label = \"BN\"] \n\"6\"->\"34\" [label = \"BN\"] \n\"8\"->\"35\" [label = \"BN\"] \n\"10\"->\"36\" [label = \"BN\"] \n\"12\"->\"37\" [label = \"BN\"] \n\"14\"->\"38\" [label = \"BN\"] \n\"16\"->\"39\" [label = \"BN\"] \n\"18\"->\"40\" [label = \"BN\"] \n\"20\"->\"41\" [label = \"BN\"] \n\"2\"->\"42\" [label = \"BT\"] \n\"4\"->\"43\" [label = \"BT\"] \n\"6\"->\"44\" [label = \"BT\"] \n\"8\"->\"45\" [label = \"BT\"] \n\"10\"->\"46\" [label = \"BT\"] \n\"12\"->\"47\" [label = \"BT\"] \n\"14\"->\"48\" [label = \"BT\"] \n\"16\"->\"49\" [label = \"BT\"] \n\"18\"->\"50\" [label = \"BT\"] \n\"20\"->\"51\" [label = \"BT\"] \n\"2\"->\"52\" [label = \"EE\"] \n\"4\"->\"53\" [label = \"EE\"] \n\"6\"->\"54\" [label = \"EE\"] \n\"8\"->\"55\" [label = \"EE\"] \n\"10\"->\"56\" [label = \"EE\"] \n\"12\"->\"57\" [label = \"EE\"] \n\"14\"->\"58\" [label = \"EE\"] \n\"16\"->\"59\" [label = \"EE\"] \n\"18\"->\"60\" [label = \"EE\"] \n\"20\"->\"61\" [label = \"EE\"] \n\"2\"->\"62\" [label = \"EN\"] \n\"4\"->\"63\" [label = \"EN\"] \n\"6\"->\"64\" [label = \"EN\"] \n\"8\"->\"65\" [label = \"EN\"] \n\"10\"->\"66\" [label = \"EN\"] \n\"12\"->\"67\" [label = \"EN\"] \n\"14\"->\"68\" [label = \"EN\"] \n\"16\"->\"69\" [label = \"EN\"] \n\"18\"->\"70\" [label = \"EN\"] \n\"20\"->\"71\" [label = \"EN\"] \n\"2\"->\"72\" [label = \"ET\"] \n\"4\"->\"73\" [label = \"ET\"] \n\"6\"->\"74\" [label = \"ET\"] \n\"8\"->\"75\" [label = \"ET\"] \n\"10\"->\"76\" [label = \"ET\"] \n\"12\"->\"77\" [label = \"ET\"] \n\"14\"->\"78\" [label = \"ET\"] \n\"16\"->\"79\" [label = \"ET\"] \n\"18\"->\"80\" [label = \"ET\"] \n\"20\"->\"81\" [label = \"ET\"] \n\"2\"->\"82\" [label = \"NN\"] \n\"4\"->\"83\" [label = \"NN\"] \n\"6\"->\"84\" [label = \"NN\"] \n\"8\"->\"85\" [label = \"NN\"] \n\"10\"->\"86\" [label = \"NN\"] \n\"12\"->\"87\" [label = \"NN\"] \n\"14\"->\"88\" [label = \"NN\"] \n\"16\"->\"89\" [label = \"NN\"] \n\"18\"->\"90\" [label = \"NN\"] \n\"20\"->\"91\" [label = \"NN\"] \n\"2\"->\"92\" [label = \"NT\"] \n\"4\"->\"93\" [label = \"NT\"] \n\"6\"->\"94\" [label = \"NT\"] \n\"8\"->\"95\" [label = \"NT\"] \n\"10\"->\"96\" [label = \"NT\"] \n\"12\"->\"97\" [label = \"NT\"] \n\"14\"->\"98\" [label = \"NT\"] \n\"16\"->\"99\" [label = \"NT\"] \n\"18\"->\"100\" [label = \"NT\"] \n\"20\"->\"101\" [label = \"NT\"] \n\"2\"->\"102\" [label = \"TT\"] \n\"4\"->\"103\" [label = \"TT\"] \n\"6\"->\"104\" [label = \"TT\"] \n\"8\"->\"105\" [label = \"TT\"] \n\"10\"->\"106\" [label = \"TT\"] \n\"12\"->\"107\" [label = \"TT\"] \n\"14\"->\"108\" [label = \"TT\"] \n\"16\"->\"109\" [label = \"TT\"] \n\"18\"->\"110\" [label = \"TT\"] \n\"20\"->\"111\" [label = \"TT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>Had there been no previous outcomes (i.e. at the start of a new
trial), we could have omitted the <code>previous_outcomes</code>
parameter.</p>
<p>We can visualise the equivalent using the Wages &amp; Tait
design:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt_paths</span> <span class="op">&lt;-</span> <span class="va">wt_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span></span>
<span>    cohort_sizes <span class="op">=</span> <span class="va">cohort_sizes</span>, </span>
<span>    previous_outcomes <span class="op">=</span> <span class="va">outcomes</span>,</span>
<span>    next_dose <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 100 paths. Be patient.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">wt_paths</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"2\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"3\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"4\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"5\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"6\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"7\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"8\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"9\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"10\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"11\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"12\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"13\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"14\" [label = \"5\", fillcolor = \"#FDE725FF\", fontcolor = \"#2A788EFF\"] \n  \"15\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"16\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"17\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"18\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"19\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"20\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"21\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"22\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"23\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"24\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"25\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"26\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"27\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"28\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"29\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"30\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"31\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"32\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"33\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"34\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"35\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"36\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"37\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"38\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"39\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"40\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"41\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"42\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"43\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"44\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"45\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"46\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"47\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"48\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"49\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"50\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"51\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"52\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"53\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"54\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"55\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"56\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"57\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"58\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"59\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"60\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"61\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"62\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"63\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"64\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"65\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"66\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"67\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"68\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"69\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"70\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"71\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"72\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"73\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"74\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"75\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"76\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"77\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"78\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"79\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"80\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"81\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n\"1\"->\"2\" [label = \"BB\"] \n\"1\"->\"3\" [label = \"BE\"] \n\"3\"->\"4\" [label = \"BB\"] \n\"1\"->\"5\" [label = \"BN\"] \n\"5\"->\"6\" [label = \"BB\"] \n\"1\"->\"7\" [label = \"BT\"] \n\"1\"->\"8\" [label = \"EE\"] \n\"8\"->\"9\" [label = \"BB\"] \n\"1\"->\"10\" [label = \"EN\"] \n\"10\"->\"11\" [label = \"BB\"] \n\"1\"->\"12\" [label = \"ET\"] \n\"12\"->\"13\" [label = \"BB\"] \n\"1\"->\"14\" [label = \"NN\"] \n\"14\"->\"15\" [label = \"BB\"] \n\"1\"->\"16\" [label = \"NT\"] \n\"16\"->\"17\" [label = \"BB\"] \n\"1\"->\"18\" [label = \"TT\"] \n\"3\"->\"19\" [label = \"BE\"] \n\"5\"->\"20\" [label = \"BE\"] \n\"8\"->\"21\" [label = \"BE\"] \n\"10\"->\"22\" [label = \"BE\"] \n\"12\"->\"23\" [label = \"BE\"] \n\"14\"->\"24\" [label = \"BE\"] \n\"16\"->\"25\" [label = \"BE\"] \n\"3\"->\"26\" [label = \"BN\"] \n\"5\"->\"27\" [label = \"BN\"] \n\"8\"->\"28\" [label = \"BN\"] \n\"10\"->\"29\" [label = \"BN\"] \n\"12\"->\"30\" [label = \"BN\"] \n\"14\"->\"31\" [label = \"BN\"] \n\"16\"->\"32\" [label = \"BN\"] \n\"3\"->\"33\" [label = \"BT\"] \n\"5\"->\"34\" [label = \"BT\"] \n\"8\"->\"35\" [label = \"BT\"] \n\"10\"->\"36\" [label = \"BT\"] \n\"12\"->\"37\" [label = \"BT\"] \n\"14\"->\"38\" [label = \"BT\"] \n\"16\"->\"39\" [label = \"BT\"] \n\"3\"->\"40\" [label = \"EE\"] \n\"5\"->\"41\" [label = \"EE\"] \n\"8\"->\"42\" [label = \"EE\"] \n\"10\"->\"43\" [label = \"EE\"] \n\"12\"->\"44\" [label = \"EE\"] \n\"14\"->\"45\" [label = \"EE\"] \n\"16\"->\"46\" [label = \"EE\"] \n\"3\"->\"47\" [label = \"EN\"] \n\"5\"->\"48\" [label = \"EN\"] \n\"8\"->\"49\" [label = \"EN\"] \n\"10\"->\"50\" [label = \"EN\"] \n\"12\"->\"51\" [label = \"EN\"] \n\"14\"->\"52\" [label = \"EN\"] \n\"16\"->\"53\" [label = \"EN\"] \n\"3\"->\"54\" [label = \"ET\"] \n\"5\"->\"55\" [label = \"ET\"] \n\"8\"->\"56\" [label = \"ET\"] \n\"10\"->\"57\" [label = \"ET\"] \n\"12\"->\"58\" [label = \"ET\"] \n\"14\"->\"59\" [label = \"ET\"] \n\"16\"->\"60\" [label = \"ET\"] \n\"3\"->\"61\" [label = \"NN\"] \n\"5\"->\"62\" [label = \"NN\"] \n\"8\"->\"63\" [label = \"NN\"] \n\"10\"->\"64\" [label = \"NN\"] \n\"12\"->\"65\" [label = \"NN\"] \n\"14\"->\"66\" [label = \"NN\"] \n\"16\"->\"67\" [label = \"NN\"] \n\"3\"->\"68\" [label = \"NT\"] \n\"5\"->\"69\" [label = \"NT\"] \n\"8\"->\"70\" [label = \"NT\"] \n\"10\"->\"71\" [label = \"NT\"] \n\"12\"->\"72\" [label = \"NT\"] \n\"14\"->\"73\" [label = \"NT\"] \n\"16\"->\"74\" [label = \"NT\"] \n\"3\"->\"75\" [label = \"TT\"] \n\"5\"->\"76\" [label = \"TT\"] \n\"8\"->\"77\" [label = \"TT\"] \n\"10\"->\"78\" [label = \"TT\"] \n\"12\"->\"79\" [label = \"TT\"] \n\"14\"->\"80\" [label = \"TT\"] \n\"16\"->\"81\" [label = \"TT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>and the BOIN12 design:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_paths</span> <span class="op">&lt;-</span> <span class="va">b_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/get_dose_paths.html">get_dose_paths</a></span><span class="op">(</span></span>
<span>    cohort_sizes <span class="op">=</span> <span class="va">cohort_sizes</span>, </span>
<span>    previous_outcomes <span class="op">=</span> <span class="va">outcomes</span>,</span>
<span>    next_dose <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; You have requested 100 paths. Be patient.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/graph_paths.html">graph_paths</a></span><span class="op">(</span><span class="va">b_paths</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"2\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"3\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"4\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"5\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"6\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"7\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"8\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"9\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"10\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"11\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"12\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"13\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"14\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"15\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"16\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"17\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"18\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"19\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"20\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"21\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"22\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"23\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"24\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"25\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"26\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"27\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"28\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"29\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"30\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"31\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"32\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"33\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"34\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"35\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"36\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"37\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"38\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"39\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"40\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"41\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"42\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"43\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"44\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"45\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"46\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"47\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"48\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"49\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"50\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"51\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"52\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"53\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"54\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"55\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"56\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"57\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"58\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"59\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"60\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"61\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"62\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"63\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"64\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"65\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"66\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"67\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"68\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"69\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"70\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"71\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"72\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"73\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"74\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"75\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"76\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"77\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"78\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"79\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"80\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"81\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"82\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"83\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"84\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"85\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"86\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"87\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"88\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"89\" [label = \"4\", fillcolor = \"#7AD151FF\", fontcolor = \"#414487FF\"] \n  \"90\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"91\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"92\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"93\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"94\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"95\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"96\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"97\" [label = \"3\", fillcolor = \"#22A884FF\", fontcolor = \"#440154FF\"] \n  \"98\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"99\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"100\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"101\" [label = \"Stop\", fillcolor = \"#440154FF\", fontcolor = \"#22A884FF\"] \n  \"102\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"103\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"104\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"105\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"106\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"107\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"108\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"109\" [label = \"2\", fillcolor = \"#2A788EFF\", fontcolor = \"#FDE725FF\"] \n  \"110\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n  \"111\" [label = \"1\", fillcolor = \"#414487FF\", fontcolor = \"#7AD151FF\"] \n\"1\"->\"2\" [label = \"BB\"] \n\"2\"->\"3\" [label = \"BB\"] \n\"1\"->\"4\" [label = \"BE\"] \n\"4\"->\"5\" [label = \"BB\"] \n\"1\"->\"6\" [label = \"BN\"] \n\"6\"->\"7\" [label = \"BB\"] \n\"1\"->\"8\" [label = \"BT\"] \n\"8\"->\"9\" [label = \"BB\"] \n\"1\"->\"10\" [label = \"EE\"] \n\"10\"->\"11\" [label = \"BB\"] \n\"1\"->\"12\" [label = \"EN\"] \n\"12\"->\"13\" [label = \"BB\"] \n\"1\"->\"14\" [label = \"ET\"] \n\"14\"->\"15\" [label = \"BB\"] \n\"1\"->\"16\" [label = \"NN\"] \n\"16\"->\"17\" [label = \"BB\"] \n\"1\"->\"18\" [label = \"NT\"] \n\"18\"->\"19\" [label = \"BB\"] \n\"1\"->\"20\" [label = \"TT\"] \n\"20\"->\"21\" [label = \"BB\"] \n\"2\"->\"22\" [label = \"BE\"] \n\"4\"->\"23\" [label = \"BE\"] \n\"6\"->\"24\" [label = \"BE\"] \n\"8\"->\"25\" [label = \"BE\"] \n\"10\"->\"26\" [label = \"BE\"] \n\"12\"->\"27\" [label = \"BE\"] \n\"14\"->\"28\" [label = \"BE\"] \n\"16\"->\"29\" [label = \"BE\"] \n\"18\"->\"30\" [label = \"BE\"] \n\"20\"->\"31\" [label = \"BE\"] \n\"2\"->\"32\" [label = \"BN\"] \n\"4\"->\"33\" [label = \"BN\"] \n\"6\"->\"34\" [label = \"BN\"] \n\"8\"->\"35\" [label = \"BN\"] \n\"10\"->\"36\" [label = \"BN\"] \n\"12\"->\"37\" [label = \"BN\"] \n\"14\"->\"38\" [label = \"BN\"] \n\"16\"->\"39\" [label = \"BN\"] \n\"18\"->\"40\" [label = \"BN\"] \n\"20\"->\"41\" [label = \"BN\"] \n\"2\"->\"42\" [label = \"BT\"] \n\"4\"->\"43\" [label = \"BT\"] \n\"6\"->\"44\" [label = \"BT\"] \n\"8\"->\"45\" [label = \"BT\"] \n\"10\"->\"46\" [label = \"BT\"] \n\"12\"->\"47\" [label = \"BT\"] \n\"14\"->\"48\" [label = \"BT\"] \n\"16\"->\"49\" [label = \"BT\"] \n\"18\"->\"50\" [label = \"BT\"] \n\"20\"->\"51\" [label = \"BT\"] \n\"2\"->\"52\" [label = \"EE\"] \n\"4\"->\"53\" [label = \"EE\"] \n\"6\"->\"54\" [label = \"EE\"] \n\"8\"->\"55\" [label = \"EE\"] \n\"10\"->\"56\" [label = \"EE\"] \n\"12\"->\"57\" [label = \"EE\"] \n\"14\"->\"58\" [label = \"EE\"] \n\"16\"->\"59\" [label = \"EE\"] \n\"18\"->\"60\" [label = \"EE\"] \n\"20\"->\"61\" [label = \"EE\"] \n\"2\"->\"62\" [label = \"EN\"] \n\"4\"->\"63\" [label = \"EN\"] \n\"6\"->\"64\" [label = \"EN\"] \n\"8\"->\"65\" [label = \"EN\"] \n\"10\"->\"66\" [label = \"EN\"] \n\"12\"->\"67\" [label = \"EN\"] \n\"14\"->\"68\" [label = \"EN\"] \n\"16\"->\"69\" [label = \"EN\"] \n\"18\"->\"70\" [label = \"EN\"] \n\"20\"->\"71\" [label = \"EN\"] \n\"2\"->\"72\" [label = \"ET\"] \n\"4\"->\"73\" [label = \"ET\"] \n\"6\"->\"74\" [label = \"ET\"] \n\"8\"->\"75\" [label = \"ET\"] \n\"10\"->\"76\" [label = \"ET\"] \n\"12\"->\"77\" [label = \"ET\"] \n\"14\"->\"78\" [label = \"ET\"] \n\"16\"->\"79\" [label = \"ET\"] \n\"18\"->\"80\" [label = \"ET\"] \n\"20\"->\"81\" [label = \"ET\"] \n\"2\"->\"82\" [label = \"NN\"] \n\"4\"->\"83\" [label = \"NN\"] \n\"6\"->\"84\" [label = \"NN\"] \n\"8\"->\"85\" [label = \"NN\"] \n\"10\"->\"86\" [label = \"NN\"] \n\"12\"->\"87\" [label = \"NN\"] \n\"14\"->\"88\" [label = \"NN\"] \n\"16\"->\"89\" [label = \"NN\"] \n\"18\"->\"90\" [label = \"NN\"] \n\"20\"->\"91\" [label = \"NN\"] \n\"2\"->\"92\" [label = \"NT\"] \n\"4\"->\"93\" [label = \"NT\"] \n\"6\"->\"94\" [label = \"NT\"] \n\"8\"->\"95\" [label = \"NT\"] \n\"10\"->\"96\" [label = \"NT\"] \n\"12\"->\"97\" [label = \"NT\"] \n\"14\"->\"98\" [label = \"NT\"] \n\"16\"->\"99\" [label = \"NT\"] \n\"18\"->\"100\" [label = \"NT\"] \n\"20\"->\"101\" [label = \"NT\"] \n\"2\"->\"102\" [label = \"TT\"] \n\"4\"->\"103\" [label = \"TT\"] \n\"6\"->\"104\" [label = \"TT\"] \n\"8\"->\"105\" [label = \"TT\"] \n\"10\"->\"106\" [label = \"TT\"] \n\"12\"->\"107\" [label = \"TT\"] \n\"14\"->\"108\" [label = \"TT\"] \n\"16\"->\"109\" [label = \"TT\"] \n\"18\"->\"110\" [label = \"TT\"] \n\"20\"->\"111\" [label = \"TT\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>As we might expect, we see distinct differences in the dose decisions
by design. EffTox will escalate in this example much more readily.</p>
<p>For more information on working with dose-paths, refer to the
dose-paths vignette.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>We can simulate trials using all designs in <code>escalation</code>.
Computation using Bayesian designs can be computationally costly so for
the purposes of illustration in this vignette, we will simulate just
twenty trials per design at the following true toxicity and efficacy
curves:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_sim</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">true_prob_tox</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.12</span>, <span class="fl">0.17</span>, <span class="fl">0.38</span>, <span class="fl">0.55</span><span class="op">)</span></span>
<span><span class="va">true_prob_eff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.27</span>, <span class="fl">0.52</span>, <span class="fl">0.54</span>, <span class="fl">0.54</span><span class="op">)</span></span></code></pre></div>
<p>To promote comparability, we will give each design just 12 patients
(again, just for illustration) and prevent each design from skipping
doses in escalation.</p>
<p>To simulate under the EffTox design, we run:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">et_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trialr_efftox.html">get_trialr_efftox</a></span><span class="op">(</span></span>
<span>  real_doses <span class="op">=</span> <span class="va">real_doses</span>,</span>
<span>  efficacy_hurdle <span class="op">=</span> <span class="fl">0.5</span>, toxicity_hurdle <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  p_e <span class="op">=</span> <span class="fl">0.1</span>, p_t <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  eff0 <span class="op">=</span> <span class="fl">0.5</span>, tox1 <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  eff_star <span class="op">=</span> <span class="fl">0.7</span>, tox_star <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  priors <span class="op">=</span> <span class="va">p</span>, </span>
<span>  <span class="co"># Low MCMC sample size purely for speed in vignette:</span></span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>, chains <span class="op">=</span> <span class="fl">1</span>, </span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/dont_skip_doses.html">dont_skip_doses</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">et_sims</span> <span class="op">&lt;-</span> <span class="va">et_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span></span>
<span>    num_sims <span class="op">=</span> <span class="va">n_sim</span>, </span>
<span>    true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>    true_prob_eff <span class="op">=</span> <span class="va">true_prob_tox</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">et_sims</span></span>
<span><span class="co">#&gt; Number of iterations: 20 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of efficacy:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt; NoDose      1      2      3      4      5 </span></span>
<span><span class="co">#&gt;   0.10   0.00   0.00   0.05   0.35   0.50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;     1     2     3     4     5 </span></span>
<span><span class="co">#&gt; 0.253 0.253 0.291 0.203 0.000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    9.00   12.00   12.00   11.85   12.00   12.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total toxicities:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     0.0     1.0     2.0     2.1     3.0     5.0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total efficacies:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    0.00    1.00    2.00    1.85    3.00    4.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Trial duration:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   5.844   8.951   9.953  10.759  12.937  22.432</span></span></code></pre></div>
<p>And under the Wages &amp; Tait design:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_wages_and_tait.html">get_wages_and_tait</a></span><span class="op">(</span></span>
<span>  tox_skeleton <span class="op">=</span> <span class="va">tox_skeleton</span>,</span>
<span>  eff_skeletons <span class="op">=</span> <span class="va">eff_skeletons</span>,</span>
<span>  tox_limit <span class="op">=</span> <span class="fl">0.3</span>, eff_limit <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  num_randomise <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/dont_skip_doses.html">dont_skip_doses</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">wt_sims</span> <span class="op">&lt;-</span> <span class="va">wt_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span></span>
<span>    num_sims <span class="op">=</span> <span class="va">n_sim</span>, </span>
<span>    true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>    true_prob_eff <span class="op">=</span> <span class="va">true_prob_tox</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">wt_sims</span></span>
<span><span class="co">#&gt; Number of iterations: 20 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of efficacy:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt; NoDose      1      2      3      4      5 </span></span>
<span><span class="co">#&gt;   0.15   0.10   0.35   0.25   0.10   0.05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;      1      2      3      4      5 </span></span>
<span><span class="co">#&gt; 0.1972 0.3239 0.2958 0.1549 0.0282 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    3.00   12.00   12.00   10.65   12.00   12.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total toxicities:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    0.00    1.00    2.00    1.75    2.25    5.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total efficacies:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    0.00    1.00    1.50    1.65    2.00    5.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Trial duration:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.3197  6.5617 11.1565 11.0194 13.9553 19.9895</span></span></code></pre></div>
<p>And under the BOIN12 design:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_boin12.html">get_boin12</a></span><span class="op">(</span></span>
<span>  num_doses <span class="op">=</span> <span class="fl">5</span>, phi_t <span class="op">=</span> <span class="fl">0.3</span>, phi_e <span class="op">=</span> <span class="fl">0.5</span>, u2 <span class="op">=</span> <span class="fl">40</span>, u3 <span class="op">=</span> <span class="fl">60</span>, n_star <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dont_skip_doses.html">dont_skip_doses</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/select_boin12_obd.html">select_boin12_obd</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">b_sims</span> <span class="op">&lt;-</span> <span class="va">b_model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/simulate_trials.html">simulate_trials</a></span><span class="op">(</span></span>
<span>    num_sims <span class="op">=</span> <span class="va">n_sim</span>, </span>
<span>    true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>    true_prob_eff <span class="op">=</span> <span class="va">true_prob_tox</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">b_sims</span></span>
<span><span class="co">#&gt; Number of iterations: 20 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of doses: 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of toxicity:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True probability of efficacy:</span></span>
<span><span class="co">#&gt;    1    2    3    4    5 </span></span>
<span><span class="co">#&gt; 0.02 0.12 0.17 0.38 0.55 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of recommendation:</span></span>
<span><span class="co">#&gt; NoDose      1      2      3      4      5 </span></span>
<span><span class="co">#&gt;   0.00   0.20   0.10   0.35   0.35   0.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Probability of administration:</span></span>
<span><span class="co">#&gt;     1     2     3     4     5 </span></span>
<span><span class="co">#&gt; 0.250 0.263 0.263 0.225 0.000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;      12      12      12      12      12      12 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total toxicities:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    1.00    1.00    2.00    1.95    2.25    4.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total efficacies:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    0.00    1.00    2.00    2.15    3.00    5.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Trial duration:</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   6.619   9.554  10.885  11.179  12.384  16.512</span></span></code></pre></div>
<p>To compare designs, however, it is much more efficient to use the
method presented in <span class="citation">Sweeting et al. (2024)</span>
using <code>simulate_compare</code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EffTox <span class="op">=</span> <span class="va">et_model</span>,</span>
<span>  WagesTait <span class="op">=</span> <span class="va">wt_model</span>,</span>
<span>  BOIN12 <span class="op">=</span> <span class="va">b_model</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_compare.html">simulate_compare</a></span><span class="op">(</span></span>
<span>  designs <span class="op">=</span> <span class="va">designs</span>, </span>
<span>  num_sims <span class="op">=</span> <span class="va">n_sim</span>, </span>
<span>  true_prob_tox <span class="op">=</span> <span class="va">true_prob_tox</span>,</span>
<span>  true_prob_eff <span class="op">=</span> <span class="va">true_prob_tox</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Running BOIN12 </span></span>
<span><span class="co">#&gt; Running EffTox </span></span>
<span><span class="co">#&gt; Running WagesTait</span></span>
<span><span class="fu"><a href="../reference/convergence_plot.html">convergence_plot</a></span><span class="op">(</span><span class="va">sims</span><span class="op">)</span></span></code></pre></div>
<p><img src="A310-EfficacyToxicity_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
<p>We stress again, the design parameters in these examples have been
chosen in haste merely for illustration. The work presented here in no
way constitutes a valid comparison of these three designs.</p>
<p>For more information on running dose-finding simulations, refer to
the simulation vignette.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lin2020boin12" class="csl-entry">
Lin, Ruitao, Yanhong Zhou, Fangrong Yan, Daniel Li, and Ying Yuan. 2020.
<span>“BOIN12: Bayesian Optimal Interval Phase i/II Trial Design for
Utility-Based Dose Finding in Immunotherapy and Targeted
Therapies.”</span> <em>JCO Precision Oncology</em> 4: 1393–1402.
</div>
<div id="ref-liu_bayesian_2015" class="csl-entry">
Liu, Suyu, and Ying Yuan. 2015. <span>“Bayesian Optimal Interval Designs
for Phase <span>I</span> Clinical Trials.”</span> <em>Journal of the
Royal Statistical Society: Series C (Applied Statistics)</em> 64 (3):
507–23. <a href="https://doi.org/10.1111/rssc.12089" class="external-link">https://doi.org/10.1111/rssc.12089</a>.
</div>
<div id="ref-sweeting2023" class="csl-entry">
Sweeting, Michael, Daniel Slade, Daniel Jackson, and Kristian Brock.
2024. <span>“Potential Outcome Simulation for Efficient Head-to-Head
Comparison of Adaptive Dose-Finding Designs.”</span> <em>arXiv Preprint
arXiv:2402.15460</em>.
</div>
<div id="ref-thall2004dose" class="csl-entry">
Thall, Peter F, and John D Cook. 2004. <span>“Dose-Finding Based on
Efficacy–Toxicity Trade-Offs.”</span> <em>Biometrics</em> 60 (3):
684–93.
</div>
<div id="ref-thall2006" class="csl-entry">
Thall, PF, JD Cook, and EH Estey. 2006. <span>“Adaptive Dose Selection
Using Efficacy-Toxicity Trade-Offs: Illustrations and Practical
Considerations.”</span> <em>Journal of Biopharmaceutical Statistics</em>
16 (5): 623–38. <a href="https://doi.org/10.1080/10543400600860394" class="external-link">https://doi.org/10.1080/10543400600860394</a>.
</div>
<div id="ref-thall2014" class="csl-entry">
Thall, PF, RC Herrick, HQ Nguyen, JJ Venier, and JC Norris. 2014.
<span>“Effective Sample Size for Computing Prior Hyperparameters in
<span>Bayesian</span> Phase <span>I</span>-<span>II</span>
Dose-Finding.”</span> <em>Clinical Trials</em> 11 (6): 657–66. <a href="https://doi.org/10.1177/1740774514547397" class="external-link">https://doi.org/10.1177/1740774514547397</a>.
</div>
<div id="ref-wages2015seamless" class="csl-entry">
Wages, Nolan A, and Christopher Tait. 2015. <span>“Seamless Phase i/II
Adaptive Design for Oncology Trials of Molecularly Targeted
Agents.”</span> <em>Journal of Biopharmaceutical Statistics</em> 25 (5):
903–20.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
