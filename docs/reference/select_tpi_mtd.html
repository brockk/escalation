<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Select dose by TPI's MTD-choosing algorithm. — select_tpi_mtd • escalation</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Select dose by TPI's MTD-choosing algorithm. — select_tpi_mtd"><meta property="og:description" content="Note: if you use this selector, it almost certainly needs to be the last
example in the chain - see Example below. This method selects dose by the
algorithm for identifying the maximum tolerable dose (MTD) described in Ji et
al. (2007). This class is intended to be used when a TPI trial has reached
its maximum sample size. Thus, it intends to make the final dose
recommendation after the regular TPI dose selection algorithm, as implemented
by get_tpi, including any additional behaviours that govern
stopping (etc), has gracefully concluded a dose-finding trial. However, the
class can be used in any scenario where there is a target toxicity rate. See
Examples. Note - this class will not override the parent dose selector when
the parent is advocating no dose. Thus this class will not reinstate a
dangerous dose."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">escalation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2.9022</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A100-DoseSelectors.html">Using escalation</a>
    </li>
    <li>
      <a href="../articles/A205-CRM.html">CRM - Continual Reassessment Method</a>
    </li>
    <li>
      <a href="../articles/A207-NBG.html">NBG - Neuenschwander, Branson &amp; Gsponer</a>
    </li>
    <li>
      <a href="../articles/A210-TPI.html">TPI - Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A220-mTPI.html">mTPI - Modified Toxicity Probability Interval Design</a>
    </li>
    <li>
      <a href="../articles/A230-BOIN.html">BOIN - Bayesian Optimal Interval Design</a>
    </li>
    <li>
      <a href="../articles/A280-TITE.html">TITE-CRM and TITE-NBG - Time-to-Event Designs</a>
    </li>
    <li>
      <a href="../articles/A310-EfficacyToxicity.html">EffTox, Wages &amp; Tait, and BOIN12 - Efficacy &amp; Toxicity Designs</a>
    </li>
    <li>
      <a href="../articles/A360-Combinations.html">BOIN-COMB - Treatment Combination Designs</a>
    </li>
    <li>
      <a href="../articles/A600-DosePaths.html">Working with dose-paths</a>
    </li>
    <li>
      <a href="../articles/A700-Simulation.html">Simulating dose-escalation trials</a>
    </li>
    <li>
      <a href="../articles/A710-SimulationComparison.html">Comparing dose-escalation designs by simulation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/brockk/escalation/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select dose by TPI's MTD-choosing algorithm.</h1>
    <small class="dont-index">Source: <a href="https://github.com/brockk/escalation/blob/HEAD/R/select_tpi_mtd.R" class="external-link"><code>R/select_tpi_mtd.R</code></a></small>
    <div class="hidden name"><code>select_tpi_mtd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Note: if you use this selector, it almost certainly needs to be the last
example in the chain - see Example below. This method selects dose by the
algorithm for identifying the maximum tolerable dose (MTD) described in Ji et
al. (2007). This class is intended to be used when a TPI trial has reached
its maximum sample size. Thus, it intends to make the final dose
recommendation after the regular TPI dose selection algorithm, as implemented
by <code><a href="get_tpi.html">get_tpi</a></code>, including any additional behaviours that govern
stopping (etc), has gracefully concluded a dose-finding trial. However, the
class can be used in any scenario where there is a target toxicity rate. See
Examples. Note - this class will not override the parent dose selector when
the parent is advocating no dose. Thus this class will not reinstate a
dangerous dose.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">select_tpi_mtd</span><span class="op">(</span></span>
<span>  <span class="va">parent_selector_factory</span>,</span>
<span>  when <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"finally"</span>, <span class="st">"always"</span><span class="op">)</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">exclusion_certainty</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-parent-selector-factory">parent_selector_factory<a class="anchor" aria-label="anchor" href="#arg-parent-selector-factory"></a></dt>
<dd><p>Object of type <code><a href="selector_factory.html">selector_factory</a></code>.</p></dd>


<dt id="arg-when">when<a class="anchor" aria-label="anchor" href="#arg-when"></a></dt>
<dd><p>Either of: 'finally' to select dose only when the parent
dose-selector has finished, by returning continue() == FALSE; or 'always'
to use this dose-selection algorithm for every dose decision. As per the
authors' original intentions, the default is 'finally'.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>We seek a dose with this probability of toxicity. If not
provided, the value will be sought from the parent dose-selector.</p></dd>


<dt id="arg-exclusion-certainty">exclusion_certainty<a class="anchor" aria-label="anchor" href="#arg-exclusion-certainty"></a></dt>
<dd><p>Numeric, threshold posterior certainty required to
exclude a dose for being excessively toxic. The authors discuss values in
the range 0.7 - 0.95. Set to a value &gt; 1 to suppress the dose exclusion
mechanism. The authors use the Greek letter xi for this parameter.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>First shape parameter of the beta prior distribution on the
probability of toxicity.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>Second shape parameter of the beta prior distribution on the
probability of toxicity.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra args are passed onwards.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>an object of type <code><a href="selector_factory.html">selector_factory</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ji, Y., Li, Y., &amp; Bekele, B. N. (2007). Dose-finding in phase I
clinical trials based on toxicity probability intervals. Clinical Trials,
4(3), 235–244. https://doi.org/10.1177/1740774507079442</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This class is intended to make the final dose selection in a mTPI2 trial:</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_tpi.html">get_tpi</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">5</span>, target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>                 k1 <span class="op">=</span> <span class="fl">1</span>, k2 <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>                 exclusion_certainty <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="stop_at_n.html">stop_at_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">select_tpi_mtd</span><span class="op">(</span>exclusion_certainty <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">'1NNN 2NTN 2NNN 3NTT'</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="va">outcomes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># However, since behaviour is modular in this package, we can use this method</span></span></span>
<span class="r-in"><span><span class="co"># to select dose at every dose decision if we wanted:</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_tpi.html">get_tpi</a></span><span class="op">(</span>num_doses <span class="op">=</span> <span class="fl">5</span>, target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>                  k1 <span class="op">=</span> <span class="fl">1</span>, k2 <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>                  exclusion_certainty <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">select_tpi_mtd</span><span class="op">(</span>when <span class="op">=</span> <span class="st">'always'</span>, exclusion_certainty <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="st">'1NNT'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="va">model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="st">'1NNN 2NNT'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># and with any underlying model:</span></span></span>
<span class="r-in"><span><span class="va">skeleton</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_dfcrm.html">get_dfcrm</a></span><span class="op">(</span>skeleton <span class="op">=</span> <span class="va">skeleton</span>, target <span class="op">=</span> <span class="va">target</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">select_tpi_mtd</span><span class="op">(</span>when <span class="op">=</span> <span class="st">'always'</span>, exclusion_certainty <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="st">'1NNT'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="va">model3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="fit.html">fit</a></span><span class="op">(</span><span class="st">'1NNN 2NNT'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="recommended_dose.html">recommended_dose</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kristian Brock, Daniel Slade, Michael Sweeting.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

